{"version":3,"file":"ez-date-input.entry-DBUmYSOV.js","sources":["../../node_modules/@sankhyalabs/ezui/dist/esm/ez-date-input.entry.js"],"sourcesContent":["import { r as registerInstance, c as createEvent, h, H as Host, g as getElement } from './index-5a720e56.js';\nimport { DateUtils, ElementIDUtils } from '@sankhyalabs/core';\nimport { C as CSSVarsUtils } from './CSSVarsUtils-acba92d7.js';\nimport { i as initI18n } from './index-b623906e.js';\n\nconst ezDateInputCss = \":host{display:block;width:100%;--ez-date-input__input--background-color:var(--background--medium, #e0e0e0);--ez-date-input__input--border-color:var(--ez-date-input__input--background-color);--ez-date-input__calendar-image:url('data:image/svg+xml;utf8,<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" version=\\\"1.1\\\" height=\\\"16px\\\" width=\\\"15px\\\"><path d=\\\"M 3.171875,5.25 C 2.6485088,5.25 2.21875,5.6797588 2.21875,6.203125 2.21875,6.7264912 2.6485088,7.15625 3.171875,7.15625 3.6952412,7.15625 4.125,6.7264912 4.125,6.203125 4.125,5.6797588 3.6952412,5.25 3.171875,5.25 Z m 2.875,0 C 5.5235088,5.25 5.09375,5.6797588 5.09375,6.203125 5.09375,6.7264912 5.5235088,7.15625 6.046875,7.15625 6.5702412,7.15625 7,6.7264912 7,6.203125 7,5.6797588 6.5702412,5.25 6.046875,5.25 Z m 2.875,0 c -0.5233662,0 -0.953125,0.4297588 -0.953125,0.953125 0,0.5233662 0.4297588,0.953125 0.953125,0.953125 0.5233662,0 0.9511719,-0.4297588 0.9511719,-0.953125 C 9.8730469,5.6797588 9.4452412,5.25 8.921875,5.25 Z m 2.873047,0 c -0.523366,0 -0.953125,0.4297588 -0.953125,0.953125 0,0.5233662 0.429759,0.953125 0.953125,0.953125 0.523366,0 0.953125,-0.4297588 0.953125,-0.953125 C 12.748047,5.6797588 12.318288,5.25 11.794922,5.25 Z M 3.171875,8.1230469 c -0.5233662,0 -0.953125,0.4297588 -0.953125,0.953125 0,0.5233662 0.4297588,0.9531251 0.953125,0.9531251 0.5233662,0 0.953125,-0.4297589 0.953125,-0.9531251 0,-0.5233662 -0.4297588,-0.953125 -0.953125,-0.953125 z m 2.875,0 c -0.5233662,0 -0.953125,0.4297588 -0.953125,0.953125 0,0.5233662 0.4297588,0.9531251 0.953125,0.9531251 C 6.5702412,10.029297 7,9.5995381 7,9.0761719 7,8.5528057 6.5702412,8.1230469 6.046875,8.1230469 Z m 2.8554688,0 c -0.5233663,0 -0.953125,0.4297588 -0.953125,0.953125 0,0.5233662 0.4297587,0.9531251 0.953125,0.9531251 0.5233661,0 0.9531249,-0.4297589 0.953125,-0.9531251 0,-0.5233662 -0.4297588,-0.953125 -0.953125,-0.953125 z m 2.9003902,0 c -0.523366,0 -0.953125,0.4297588 -0.953125,0.953125 0,0.5233662 0.429759,0.9531251 0.953125,0.9531251 0.523367,0 0.953125,-0.4297589 0.953125,-0.9531251 0,-0.5233662 -0.429758,-0.953125 -0.953125,-0.953125 z M 3.171875,10.998047 c -0.5233662,0 -0.953125,0.429759 -0.953125,0.953125 0,0.523366 0.4297588,0.953125 0.953125,0.953125 0.5233662,0 0.953125,-0.429759 0.953125,-0.953125 0,-0.523366 -0.4297588,-0.953125 -0.953125,-0.953125 z m 2.875,0 c -0.5233662,0 -0.953125,0.429759 -0.953125,0.953125 0,0.523366 0.4297588,0.953125 0.953125,0.953125 C 6.5702412,12.904297 7,12.474538 7,11.951172 7,11.427806 6.5702412,10.998047 6.046875,10.998047 Z m 2.8554688,0 c -0.5233663,0 -0.953125,0.429759 -0.953125,0.953125 0,0.523366 0.4297587,0.953125 0.953125,0.953125 0.5233661,0 0.9531249,-0.429759 0.953125,-0.953125 0,-0.523366 -0.4297588,-0.953125 -0.953125,-0.953125 z m 2.9003902,0 c -0.523366,0 -0.953125,0.429759 -0.953125,0.953125 0,0.523366 0.429759,0.953125 0.953125,0.953125 0.523367,0 0.953125,-0.429759 0.953125,-0.953125 0,-0.523366 -0.429758,-0.953125 -0.953125,-0.953125 z M 3.5,0 c -0.554,0 -1,0.446 -1,1 v 0.050781 C 1.0853217,1.2909766 0,2.5186658 0,4 v 9 c 0,1.652487 1.3475134,3 3,3 h 9 c 1.652487,0 3,-1.347513 3,-3 V 4 C 15,2.5186658 13.914678,1.2909766 12.5,1.0507812 V 1 c 0,-0.554 -0.446,-1 -1,-1 -0.554,0 -1,0.446 -1,1 h -2 c 0,-0.554 -0.446,-1 -1,-1 -0.554,0 -1,0.446 -1,1 h -2 C 4.5,0.446 4.054,0 3.5,0 Z m 1,2.0996094 h 2 v 0.640625 c 0,0.554 0.446,1 1,1 0.554,0 1,-0.446 1,-1 v -0.640625 h 2 v 0.640625 c 0,0.554 0.446,1 1,1 0.554,0 1,-0.446 1,-1 V 2.1738281 C 13.311725,2.3905225 13.900391,3.11278 13.900391,4 v 9 c 0,1.062113 -0.838278,1.900391 -1.900391,1.900391 H 3 C 1.9378864,14.900391 1.0996094,14.062113 1.0996094,13 V 4 C 1.0996094,3.11278 1.6882747,2.3905225 2.5,2.1738281 v 0.5664063 c 0,0.554 0.446,1 1,1 0.554,0 1,-0.446 1,-1 z\\\"/></svg>')}.btn-open-cal{outline:none;border:none;background-color:unset;cursor:pointer}.btn-open-cal:disabled{cursor:not-allowed}.btn-open-cal::after{content:'';display:flex;background-color:var(--text--primary, #008561);width:15px;height:16px;-webkit-mask-image:var(--ez-date-input__calendar-image);mask-image:var(--ez-date-input__calendar-image)}.btn-open-cal:disabled:after{background-color:var(--text--disable, #AFB6C0)}.btn-open-cal:enabled:hover::after{background-color:var(--color--primary, #4e4e4e)}ez-text-input{--text-input__input--background-color:var(--ez-date-input__input--background-color, #FFFFFF);--text-input__input--border-color:var(--ez-date-input__input--border-color, #DCE0E8)}\";\n\nconst EzDateInput = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.ezChange = createEvent(this, \"ezChange\", 7);\n    this.ezStartChange = createEvent(this, \"ezStartChange\", 7);\n    this.ezCancelWaitingChange = createEvent(this, \"ezCancelWaitingChange\", 7);\n    this._changePending = false;\n    this._focused = false;\n    this._valuePromiseCallbacks = [];\n    this.label = undefined;\n    this.value = undefined;\n    this.enabled = true;\n    this.errorMessage = undefined;\n    this.mode = \"regular\";\n    this.canShowError = true;\n    this.autoFocus = false;\n    this.alternativePlaceholder = undefined;\n  }\n  observeLabel() {\n    if (this._textInput) {\n      this._textInput.label = this.label;\n    }\n  }\n  observeErrorMessage() {\n    var _a;\n    if (this._textInput) {\n      this._textInput.errorMessage = this.errorMessage;\n      if (!((_a = this.errorMessage) === null || _a === void 0 ? void 0 : _a.trim())) {\n        this.setInputValue();\n      }\n    }\n  }\n  observeValue(newValue, oldValue) {\n    if (this._textInput && newValue != oldValue) {\n      const newValueValidated = DateUtils.validateDate(newValue);\n      const oldValueValidated = DateUtils.validateDate(oldValue);\n      if ((newValueValidated === null || newValueValidated === void 0 ? void 0 : newValueValidated.getTime()) !== (oldValueValidated === null || oldValueValidated === void 0 ? void 0 : oldValueValidated.getTime())) {\n        const textValue = this.getTextValue(newValueValidated) || '';\n        const parsedDate = DateUtils.strToDate(textValue);\n        if ((parsedDate || !this._focused) && (this._textInput.value || '') !== textValue) {\n          this._textInput.value = textValue;\n          this._focused = false;\n          this.errorMessage = \"\";\n        }\n        const valueEmitted = newValueValidated === null ? undefined : newValueValidated;\n        this.ezChange.emit(valueEmitted);\n      }\n    }\n    this._changePending = false;\n  }\n  /**\n   * Aplica o foco no campo.\n   */\n  async setFocus(options) {\n    this._textInput.setFocus(options);\n  }\n  /**\n   * Remove o foco do campo.\n   */\n  async setBlur() {\n    this._textInput.setBlur();\n  }\n  /**\n   * Retorna se o conteúdo é inválido.\n   */\n  async isInvalid() {\n    return typeof this.errorMessage === \"string\" && this.errorMessage.trim() !== \"\";\n  }\n  /*\n  * Retorna uma promise com o valor da opção selecionada,\n  * que será resolvida quando o backend devolver este dado.\n  */\n  async getValueAsync() {\n    if (this._changePending) {\n      return new Promise(accept => {\n        this._valuePromiseCallbacks.push(accept);\n      });\n    }\n    return Promise.resolve(this.value);\n  }\n  changeValue(newValue) {\n    const currentValue = DateUtils.validateDate(this.value);\n    const newValueValidated = DateUtils.validateDate(newValue);\n    if ((currentValue === null || currentValue === void 0 ? void 0 : currentValue.getTime()) !== (newValueValidated === null || newValueValidated === void 0 ? void 0 : newValueValidated.getTime())) {\n      this.value = newValueValidated;\n    }\n    else {\n      this._changePending = false;\n    }\n  }\n  hideCalendar() {\n    this.changeValue(this._calendar.value);\n    this._popover.hide();\n  }\n  handleBlur() {\n    if (!this._changePending) {\n      return;\n    }\n    try {\n      const strValue = this._textInput.value;\n      const newValue = DateUtils.strToDate(strValue);\n      if (newValue || !strValue) {\n        this.errorMessage = \"\";\n        const currentValue = DateUtils.validateDate(this.value);\n        const newValueValidated = DateUtils.validateDate(newValue);\n        if ((currentValue === null || currentValue === void 0 ? void 0 : currentValue.getTime()) === (newValueValidated === null || newValueValidated === void 0 ? void 0 : newValueValidated.getTime())) {\n          if (newValueValidated) {\n            this._textInput.value = this.getTextValue(newValueValidated) || '';\n            this._focused = false;\n          }\n          this.ezCancelWaitingChange.emit();\n        }\n        else {\n          this._focused = false;\n          this.changeValue(newValueValidated);\n        }\n      }\n      else {\n        this.changeValue(undefined);\n        this.ezCancelWaitingChange.emit();\n        this.errorMessage = this.i18n(\"ez-date-input.invalidDate\");\n      }\n    }\n    finally {\n      for (const callback of this._valuePromiseCallbacks) {\n        callback(this.value);\n      }\n      this._valuePromiseCallbacks = [];\n    }\n  }\n  getTextValue(d) {\n    return d ? DateUtils.formatDate(d) : undefined;\n  }\n  handleInput(event) {\n    const strValue = this._textInput.value;\n    const newValue = DateUtils.strToDate(strValue);\n    const currentValue = DateUtils.validateDate(this.value);\n    const newValueValidated = DateUtils.validateDate(newValue);\n    if ((currentValue === null || currentValue === void 0 ? void 0 : currentValue.getTime()) !== (newValueValidated === null || newValueValidated === void 0 ? void 0 : newValueValidated.getTime())) {\n      this._changePending = true;\n      this._focused = true;\n      this.ezStartChange.emit({ waitmessage: \"\", blocking: false });\n    }\n    if (event['data'] === \"H\" || event['data'] === \"h\") {\n      this.changeValue(new Date());\n    }\n  }\n  setInputValue() {\n    const textValue = this.getTextValue(this.value) || '';\n    if ((this._textInput.value || '') !== textValue) {\n      this._textInput.value = textValue;\n    }\n  }\n  disconnectedCallback() {\n    this._popover.hide();\n  }\n  async componentWillLoad() {\n    this.i18n = await initI18n();\n  }\n  componentDidLoad() {\n    CSSVarsUtils.applyVarsTextInput(this._elem, this._textInput);\n    this.setInputValue();\n    if (this.autoFocus) {\n      requestAnimationFrame(() => {\n        this.setFocus({ selectText: true });\n      });\n    }\n  }\n  render() {\n    ElementIDUtils.addIDInfoIfNotExists(this._elem, 'input');\n    return (h(Host, null, h(\"ez-text-input\", { \"data-element-id\": ElementIDUtils.getInternalIDInfo(\"textInput\"), ref: elem => this._textInput = elem, \"data-slave-mode\": \"true\", label: this.label, onBlur: () => this.handleBlur(), onInput: (evt) => this.handleInput(evt), restrict: \"0123456789/\", enabled: this.enabled, errorMessage: this.errorMessage, mode: this.mode, canShowError: this.canShowError, alternativePlaceholder: this.alternativePlaceholder }, h(\"button\", { disabled: !this.enabled, tabindex: -1, class: \"btn-open-cal\", onClick: () => { var _a; return (_a = this._popover) === null || _a === void 0 ? void 0 : _a.showUnder(this._textInput); }, slot: \"leftIcon\" })), h(\"ez-popover-plus\", { ref: elem => this._popover = elem, anchorElement: this._textInput, autoClose: true, boxWidth: 'fit-content', overlayType: 'none', \"data-element-id\": this._elem.getAttribute(\"data-element-id\") }, h(\"ez-calendar\", { ref: elem => this._calendar = elem, \"data-element-id\": ElementIDUtils.getInternalIDInfo(\"calendar\"), onEzChange: (event) => { this.hideCalendar(); event.stopPropagation(); } }))));\n  }\n  get _elem() { return getElement(this); }\n  static get watchers() { return {\n    \"label\": [\"observeLabel\"],\n    \"errorMessage\": [\"observeErrorMessage\"],\n    \"value\": [\"observeValue\"]\n  }; }\n};\nEzDateInput.style = ezDateInputCss;\n\nexport { EzDateInput as ez_date_input };\n"],"names":["ezDateInputCss","EzDateInput","hostRef","registerInstance","createEvent","_a","newValue","oldValue","newValueValidated","DateUtils","oldValueValidated","textValue","valueEmitted","options","accept","currentValue","strValue","callback","d","event","initI18n","CSSVarsUtils","ElementIDUtils","h","Host","elem","evt","getElement"],"mappings":"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","x_google_ignoreList":[0]}
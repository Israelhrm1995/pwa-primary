import{b as c,d as u,e as o,k as v,i as p}from"./index-DyPwdCiV.js";import{f as n,T as g,E as d}from"./dataUnitInMemoryLoader-CwDmnNwL.js";import{C as m}from"./CSSVarsUtils-acba92d7-BCgqr3Ak.js";import"./vendor-ChHGKcPm.js";const f=`:host{display:block;width:100%;--ez-date-input__input--background-color:var(--background--medium, #e0e0e0);--ez-date-input__input--border-color:var(--ez-date-input__input--background-color);--ez-date-input__calendar-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="16px" width="15px"><path d="M 3.171875,5.25 C 2.6485088,5.25 2.21875,5.6797588 2.21875,6.203125 2.21875,6.7264912 2.6485088,7.15625 3.171875,7.15625 3.6952412,7.15625 4.125,6.7264912 4.125,6.203125 4.125,5.6797588 3.6952412,5.25 3.171875,5.25 Z m 2.875,0 C 5.5235088,5.25 5.09375,5.6797588 5.09375,6.203125 5.09375,6.7264912 5.5235088,7.15625 6.046875,7.15625 6.5702412,7.15625 7,6.7264912 7,6.203125 7,5.6797588 6.5702412,5.25 6.046875,5.25 Z m 2.875,0 c -0.5233662,0 -0.953125,0.4297588 -0.953125,0.953125 0,0.5233662 0.4297588,0.953125 0.953125,0.953125 0.5233662,0 0.9511719,-0.4297588 0.9511719,-0.953125 C 9.8730469,5.6797588 9.4452412,5.25 8.921875,5.25 Z m 2.873047,0 c -0.523366,0 -0.953125,0.4297588 -0.953125,0.953125 0,0.5233662 0.429759,0.953125 0.953125,0.953125 0.523366,0 0.953125,-0.4297588 0.953125,-0.953125 C 12.748047,5.6797588 12.318288,5.25 11.794922,5.25 Z M 3.171875,8.1230469 c -0.5233662,0 -0.953125,0.4297588 -0.953125,0.953125 0,0.5233662 0.4297588,0.9531251 0.953125,0.9531251 0.5233662,0 0.953125,-0.4297589 0.953125,-0.9531251 0,-0.5233662 -0.4297588,-0.953125 -0.953125,-0.953125 z m 2.875,0 c -0.5233662,0 -0.953125,0.4297588 -0.953125,0.953125 0,0.5233662 0.4297588,0.9531251 0.953125,0.9531251 C 6.5702412,10.029297 7,9.5995381 7,9.0761719 7,8.5528057 6.5702412,8.1230469 6.046875,8.1230469 Z m 2.8554688,0 c -0.5233663,0 -0.953125,0.4297588 -0.953125,0.953125 0,0.5233662 0.4297587,0.9531251 0.953125,0.9531251 0.5233661,0 0.9531249,-0.4297589 0.953125,-0.9531251 0,-0.5233662 -0.4297588,-0.953125 -0.953125,-0.953125 z m 2.9003902,0 c -0.523366,0 -0.953125,0.4297588 -0.953125,0.953125 0,0.5233662 0.429759,0.9531251 0.953125,0.9531251 0.523367,0 0.953125,-0.4297589 0.953125,-0.9531251 0,-0.5233662 -0.429758,-0.953125 -0.953125,-0.953125 z M 3.171875,10.998047 c -0.5233662,0 -0.953125,0.429759 -0.953125,0.953125 0,0.523366 0.4297588,0.953125 0.953125,0.953125 0.5233662,0 0.953125,-0.429759 0.953125,-0.953125 0,-0.523366 -0.4297588,-0.953125 -0.953125,-0.953125 z m 2.875,0 c -0.5233662,0 -0.953125,0.429759 -0.953125,0.953125 0,0.523366 0.4297588,0.953125 0.953125,0.953125 C 6.5702412,12.904297 7,12.474538 7,11.951172 7,11.427806 6.5702412,10.998047 6.046875,10.998047 Z m 2.8554688,0 c -0.5233663,0 -0.953125,0.429759 -0.953125,0.953125 0,0.523366 0.4297587,0.953125 0.953125,0.953125 0.5233661,0 0.9531249,-0.429759 0.953125,-0.953125 0,-0.523366 -0.4297588,-0.953125 -0.953125,-0.953125 z m 2.9003902,0 c -0.523366,0 -0.953125,0.429759 -0.953125,0.953125 0,0.523366 0.429759,0.953125 0.953125,0.953125 0.523367,0 0.953125,-0.429759 0.953125,-0.953125 0,-0.523366 -0.429758,-0.953125 -0.953125,-0.953125 z M 3.5,0 c -0.554,0 -1,0.446 -1,1 v 0.050781 C 1.0853217,1.2909766 0,2.5186658 0,4 v 9 c 0,1.652487 1.3475134,3 3,3 h 9 c 1.652487,0 3,-1.347513 3,-3 V 4 C 15,2.5186658 13.914678,1.2909766 12.5,1.0507812 V 1 c 0,-0.554 -0.446,-1 -1,-1 -0.554,0 -1,0.446 -1,1 h -2 c 0,-0.554 -0.446,-1 -1,-1 -0.554,0 -1,0.446 -1,1 h -2 C 4.5,0.446 4.054,0 3.5,0 Z m 1,2.0996094 h 2 v 0.640625 c 0,0.554 0.446,1 1,1 0.554,0 1,-0.446 1,-1 v -0.640625 h 2 v 0.640625 c 0,0.554 0.446,1 1,1 0.554,0 1,-0.446 1,-1 V 2.1738281 C 13.311725,2.3905225 13.900391,3.11278 13.900391,4 v 9 c 0,1.062113 -0.838278,1.900391 -1.900391,1.900391 H 3 C 1.9378864,14.900391 1.0996094,14.062113 1.0996094,13 V 4 C 1.0996094,3.11278 1.6882747,2.3905225 2.5,2.1738281 v 0.5664063 c 0,0.554 0.446,1 1,1 0.554,0 1,-0.446 1,-1 z"/></svg>')}.btn-open-cal{outline:none;border:none;background-color:unset;cursor:pointer}.btn-open-cal:disabled{cursor:not-allowed}.btn-open-cal::after{content:'';display:flex;background-color:var(--text--primary, #008561);width:15px;height:16px;-webkit-mask-image:var(--ez-date-input__calendar-image);mask-image:var(--ez-date-input__calendar-image)}.btn-open-cal:disabled:after{background-color:var(--text--disable, #AFB6C0)}.btn-open-cal:enabled:hover::after{background-color:var(--color--primary, #4e4e4e)}ez-text-input{--text-input__input--background-color:var(--ez-date-input__input--background-color, #FFFFFF);--text-input__input--border-color:var(--ez-date-input__input--border-color, #DCE0E8)}`,_=class{constructor(e){c(this,e),this.ezChange=u(this,"ezChange"),this.ezStartChange=u(this,"ezStartChange"),this.ezCancelWaitingChange=u(this,"ezCancelWaitingChange"),this._changePending=!1,this._focused=!1,this._valuePromiseCallbacks=[],this.label=void 0,this.value=void 0,this.enabled=!0,this.errorMessage=void 0,this.showSeconds=!1,this.mode="regular",this.canShowError=!0,this.autoFocus=!1,this.alternativePlaceholder=void 0}observeLabel(){this._textInput&&(this._textInput.label=this.label)}observeErrorMessage(){var e;this._textInput&&(this._textInput.errorMessage=this.errorMessage,!((e=this.errorMessage)===null||e===void 0)&&e.trim()||this.setInputValue())}observeValue(e,t){if(this._textInput&&e!=t){const a=n.validateDate(e,!0),i=n.validateDate(t,!0);if((a==null?void 0:a.getTime())!==(i==null?void 0:i.getTime())){const s=this.getTextValue(a)||"";(this.getParsedDateTime(s)||!this._focused)&&(this._textInput.value||"")!==s&&(this._textInput.value=s,this._focused=!1,this.errorMessage="");const r=a===null?void 0:a;this.ezChange.emit(r)}}this._changePending=!1}async setFocus(e){this._textInput.setFocus(e)}async setBlur(){this._textInput.setBlur()}async isInvalid(){return typeof this.errorMessage=="string"&&this.errorMessage.trim()!==""}async getValueAsync(){return this._changePending?new Promise(e=>{this._valuePromiseCallbacks.push(e)}):Promise.resolve(this.value)}handleKeyDown(e){const t=this._textInput.shadowRoot.querySelector("input");if(e.shiftKey&&e.key==="Tab"){if(t.selectionStart>0){let a=t.value.lastIndexOf(" ",t.selectionStart);a!==-1&&(t.setSelectionRange(0,a),e.preventDefault())}}else if(e.key==="Tab"&&t.value.length!==t.selectionEnd){let a=t.value.indexOf(" ",t.selectionEnd);a=a===-1?t.selectionEnd:a+1,t.setSelectionRange(a,t.value.length),e.preventDefault()}}handleFocus(){const e=this._textInput.shadowRoot.querySelector("input");if(e.selectionStart!==e.selectionEnd){let t=e.value.indexOf(" ",e.selectionStart);t=t===-1?e.value.length:t,e.setSelectionRange(0,t)}}handleClick(){const e=this._textInput.shadowRoot.querySelector("input");let t=e.value.lastIndexOf(" ",e.selectionEnd);t=t===-1?0:t+1,t=t>e.selectionEnd?0:t;let a=t===0?e.value.indexOf(" "):e.value.length;e.setSelectionRange(t,a)}changeValue(e){const t=n.validateDate(this.value,!0),a=n.validateDate(e,!0);(t==null?void 0:t.getTime())!==(a==null?void 0:a.getTime())&&(this.value=a)}hideCalendar(){this.changeValue(this._calendar.value),this._popover.hide()}getParsedDateTime(e){var t,a;if(e===void 0&&(e=((a=(t=this._textInput)===null||t===void 0?void 0:t.value)===null||a===void 0?void 0:a.trim())||""),!e)return;const i=e.split(" "),s=i.length>0?i[0]:e,l=i[1]?i[1]:"",r=g.prepareValue(l,this.showSeconds),h=s+(r&&" "+r);return n.strToDate(h)}handleBlur(){var e,t;if(this._changePending)try{const a=((t=(e=this._textInput)===null||e===void 0?void 0:e.value)===null||t===void 0?void 0:t.trim())||"",i=this.getParsedDateTime();if(i||!a){this.errorMessage="";const s=n.validateDate(this.value,!0),l=n.validateDate(i,!0);(s==null?void 0:s.getTime())===(l==null?void 0:l.getTime())?(l&&(this._textInput.value=this.getTextValue(l)||"",this._focused=!1),this.ezCancelWaitingChange.emit()):this.changeValue(l)}else this.changeValue(void 0),this.ezCancelWaitingChange.emit(),this.errorMessage="O valor digitado não é uma data válida"}finally{for(const a of this._valuePromiseCallbacks)a(this.value);this._valuePromiseCallbacks=[]}}getTextValue(e){if(e)return n.formatDateTime(e,this.showSeconds)}handleInput(e){const t=this.getParsedDateTime(),a=n.validateDate(this.value,!0),i=n.validateDate(t,!0);(a==null?void 0:a.getTime())!==(i==null?void 0:i.getTime())&&(this._changePending=!0,this._focused=!0,this.ezStartChange.emit({waitmessage:"",blocking:!1})),(e.data==="H"||e.data==="h")&&this.changeValue(new Date)}setInputValue(){const e=this.getTextValue(this.value)||"";(this._textInput.value||"")!==e&&(this._textInput.value=e)}disconnectedCallback(){this._popover.hide()}componentDidLoad(){m.applyVarsTextInput(this._elem,this._textInput),this.setInputValue(),this.autoFocus&&requestAnimationFrame(()=>{this.setFocus({selectText:!0})})}render(){return d.addIDInfoIfNotExists(this._elem,"input"),o(v,null,o("ez-text-input",{"data-element-id":d.getInternalIDInfo("textInput"),ref:e=>this._textInput=e,"data-slave-mode":"true",label:this.label,restrict:"0123456789/: ",enabled:this.enabled,errorMessage:this.errorMessage,mode:this.mode,onKeyDown:e=>{this.handleKeyDown(e)},onBlur:()=>this.handleBlur(),onInput:e=>this.handleInput(e),onFocus:()=>this.handleFocus(),onClick:()=>this.handleClick(),canShowError:this.canShowError,alternativePlaceholder:this.alternativePlaceholder},o("button",{disabled:!this.enabled,tabindex:-1,class:"btn-open-cal",onClick:()=>{var e;return(e=this._popover)===null||e===void 0?void 0:e.showUnder(this._textInput)},slot:"leftIcon"})),o("ez-popover-plus",{ref:e=>this._popover=e,anchorElement:this._textInput,autoClose:!0,boxWidth:"fit-content",overlayType:"none"},o("ez-calendar",{ref:e=>this._calendar=e,"data-element-id":d.getInternalIDInfo("calendar"),onEzChange:e=>{this.hideCalendar(),e.stopPropagation()},time:!0,showSeconds:this.showSeconds})))}get _elem(){return p(this)}static get watchers(){return{label:["observeLabel"],errorMessage:["observeErrorMessage"],value:["observeValue"]}}};_.style=f;export{_ as ez_date_time_input};

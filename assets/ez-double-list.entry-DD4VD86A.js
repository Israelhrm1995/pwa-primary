import{v,w as f,O as g,y as R,x as r,C as S}from"./index-C7RI_ets.js";import{i as u}from"./ezListHelper-00fb9b8d-D0QwO7to.js";function T(t,e,i){if(!t.length)return[...e];if(!e.length)return[];const s=z(t,e),n=I(s),l=p(s);return y(n,l,i,e)}function I(t){return t.length===0?0:t.reduce((e,i)=>i<e?i:e,t[0])}function p(t){return t.length===0?0:t.reduce((e,i)=>i>e?i:e,t[0])}function z(t,e){return t.map(i=>e.findIndex(s=>s.id===i))}function y(t,e,i,s){return t<0||e>=s.length||t>e?s:i?_(e,t,s):C(t,e,s)}function C(t,e,i){if(t===0)return i;const s=i.slice(0,t-1),n=i.slice(t,e+1),l=i.slice(e+1),h=i[t-1];return[...s,...n,h,...l]}function _(t,e,i){if(t===i.length-1)return i;const s=i.slice(0,e),n=i.slice(e,t+1),l=i.slice(t+1),h=l.shift();return h?[...s,h,...n,...l]:i}function b({from:t,to:e,selectedFrom:i,selectedTo:s}){return e=[...e.map(n=>c(n,!1)),...t.map(n=>c(n,!0))],i=[],s=[...t.map(({id:n})=>n)],t=[],{from:t,to:e,selectedFrom:i,selectedTo:s}}function m({from:t,to:e,selectedFrom:i,selectedTo:s,insertIndex:n=e.length}){if(!t.length)return{from:t,to:e,selectedFrom:i,selectedTo:s};const l=F(e,i,t);if(!l.length)return{from:t,to:e,selectedFrom:i,selectedTo:s};let h=e.map(o=>c(o,!1));return h.splice(n,0,...l.map(o=>c(o,!0))),{from:t.filter(o=>!i.includes(o.id)),to:h,selectedFrom:[],selectedTo:[...i]}}function F(t,e,i){const s=t.map(l=>l.id),n=e.filter(l=>!s.includes(l));return i.filter(({id:l})=>n.includes(l))}function c(t,e){return Object.assign(Object.assign({},t),{selected:e})}const M='.sc-ez-double-list-h{display:flex;flex-direction:row;gap:8px;align-items:center;font-family:var(--font-pattern, "Roboto");width:100%}@media screen and (max-width: 1366px){.group.sc-ez-double-list{height:350px}}.list__container.sc-ez-double-list{height:100%;width:100%;min-height:150px;overflow:auto;display:flex}.actions__column.sc-ez-double-list{display:flex;flex-direction:column;gap:4px}',A=class{constructor(t){v(this,t),this.ezLeftListChanged=f(this,"ezLeftListChanged"),this.ezRightListChanged=f(this,"ezRightListChanged"),this.LEFT_LIST_ID="LEFT-LIST-ID",this.RIGHT_LIST_ID="RIGHT-LIST-ID",this.leftList=[],this.leftTitle=void 0,this.rightList=[],this.entityLabel="item",this.entityLabelPlural="itens",this.leftListLabel="disponÃ­veis",this.rightListLabel="selecionados",this.useOnlyRightList=!1,this.rightTitle=void 0,this.emptyMessage=void 0,this.slotsListBuilder=void 0,this.leftFilteredList=[],this.rightFilteredList=[],this.selectedLeftList=[],this.selectedRightList=[],this.isFilteringLeft=!1,this.isFilteringRight=!1}async resetSelectedLists(){this.selectedLeftList=[],this.selectedRightList=[]}observeLeftList(t,e){g.equals(t,e)||this.ezLeftListChanged.emit(t)}observeRightList(t,e){g.equals(t,e)||this.ezRightListChanged.emit(t)}async componentWillLoad(){this.i18n=await R()}async handleChangeLeft({detail:t}){if(!t.to.getAttribute("id")||t.to.getAttribute("id")!==this.RIGHT_LIST_ID){this.leftList=[...this.reorderArray(t.dataSource,t.selectItens,t.newIndex)];return}t.selectItens=t.selectItens.filter(e=>this.rightList.every(i=>i.id!==e)),this.leftList=[...t.dataSource],this.selectedLeftList=[...t.selectItens],this.transferToRight(t==null?void 0:t.newIndex)}async handleChangeRight({detail:t}){if(!t.to.getAttribute("id")||t.to.getAttribute("id")!==this.LEFT_LIST_ID){this.rightList=[...this.reorderArray(t.dataSource,t.selectItens,t.newIndex)];return}t.selectItens=t.selectItens.filter(e=>this.leftList.every(i=>i.id!==e)),this.rightList=[...t.dataSource],this.selectedRightList=[...t.selectItens],this.transferToLeft(t==null?void 0:t.newIndex)}reorderArray(t,e,i){const s=t.filter(l=>!e.includes(l.id)),n=t.filter(l=>e.includes(l.id));return s.splice(i,0,...n),s}enableTransferAllToRight(){return this.leftList.length>0}enableTransferAllToLeft(){return this.rightList.length>0}enableTransferToRight(){return this.selectedLeftList.length>0}enableTransferToLeft(){return this.selectedRightList.length>0}enableMoveUp(t){if(this.isFilteringRight)return!1;const e=this.getRightSelectedItemsIndex();return this.selectedRightList.length>0&&!e.includes(0)&&(t?!0:u(e))}enableMoveDown(t){if(this.isFilteringRight)return!1;const e=this.getRightSelectedItemsIndex(),i=this.rightList.length-1;return this.selectedRightList.length>0&&!e.includes(i)&&(t?!0:u(e))}getRightSelectedItemsIndex(){return this.selectedRightList.map(t=>this.rightList.findIndex(e=>e.id===t))}transferToRight(t){const{from:e,to:i,selectedFrom:s,selectedTo:n}=m(Object.assign(Object.assign({},this.buildTransferToRightConfig()),{insertIndex:t??0}));this.leftList=[],requestAnimationFrame(()=>this.leftList=[...e]),this.rightList=[...i],this.selectedLeftList=[...s],this.selectedRightList=[...n]}transferToLeft(t){const{from:e,to:i,selectedFrom:s,selectedTo:n}=m(Object.assign(Object.assign({},this.buildTransferToLeftConfig()),{insertIndex:t??0}));this.rightList=[],requestAnimationFrame(()=>this.rightList=[...e]),this.leftList=[...i],this.selectedRightList=[...s],this.selectedLeftList=[...n]}async handleTransferAllToRight(){const{from:t,to:e,selectedFrom:i,selectedTo:s}=b(this.buildTransferToRightConfig());this.leftList=[...t],this.rightList=[...e],this.selectedLeftList=[...i],this.selectedRightList=[...s],requestAnimationFrame(async()=>{await this.clearSelectionAll()})}async handleTransferAllToLeft(){const{from:t,to:e,selectedFrom:i,selectedTo:s}=b(this.buildTransferToLeftConfig());this.rightList=[...t],this.leftList=[...e],this.selectedRightList=[...i],this.selectedLeftList=[...s],requestAnimationFrame(async()=>{await this.clearSelectionAll()})}buildTransferToRightConfig(){return{from:this.leftList,to:this.rightList,selectedFrom:this.selectedLeftList,selectedTo:this.selectedRightList}}buildTransferToLeftConfig(){return{from:this.rightList,to:this.leftList,selectedFrom:this.selectedRightList,selectedTo:this.selectedLeftList}}handleMoveUp(){this.rightList=[...T(this.selectedRightList,this.rightList,!1)]}handleMoveDown(){this.rightList=[...T(this.selectedRightList,this.rightList,!0)]}handleMoveToTop(){const{itemsToKeep:t,itemsToMove:e}=this.getItemsToKeepAndToMove();this.rightList=[...e,...t]}handleMoveToBottom(){const{itemsToKeep:t,itemsToMove:e}=this.getItemsToKeepAndToMove();this.rightList=[...t,...e]}handleSelectLeftItem({detail:t}){this.selectedLeftList=[...t.map(({id:e})=>e)]}handleSelectRightItem({detail:t}){this.selectedRightList=[...t.map(({id:e})=>e)]}getItemsToKeepAndToMove(){const t=this.rightList.filter(i=>!this.selectedRightList.includes(i.id)),e=this.rightList.filter(i=>this.selectedRightList.includes(i.id));return{itemsToKeep:t,itemsToMove:e}}async handleTransferToRight(){this.transferToRight(),this.leftFilteredList=[],await this.leftEzListInstance.clearSelection()}async handleTransferToLeft(){this.transferToLeft(),this.rightFilteredList=[],await this.rightEzListInstance.clearSelection()}async clearSelectionAll(){await this.rightEzListInstance.clearSelection(),await this.leftEzListInstance.clearSelection()}handleChooseLeft(){requestAnimationFrame(async()=>{await this.rightEzListInstance.clearSelection()})}handleChooseRight(){this.useOnlyRightList||requestAnimationFrame(async()=>{await this.leftEzListInstance.clearSelection()})}renderList(t){const{idSortableList:e,list:i,isFiltering:s,filteredList:n,emptyMessage:l,slotConfig:h,callbacks:o,title:d}=t;return r("ez-sortable-list",{ref:o==null?void 0:o.setRef,title:d,idSortableList:e,emptyMessage:l,class:"ez-size-height--full",dataSource:s?n:i,hoverFeedback:!0,enableMultipleSelection:!0,removeItensMoved:!0,entityLabel:this.entityLabel,entityLabelPlural:this.entityLabelPlural,itemRightSlotBuilder:h==null?void 0:h.itemRightSlotBuilder,itemLeftSlotBuilder:h==null?void 0:h.itemLeftSlotBuilder,onItemsReordered:o==null?void 0:o.onChange.bind(this),onEzSelectItens:o==null?void 0:o.onSelect.bind(this),onEzDoubleClick:o==null?void 0:o.onDoubleClick.bind(this),onEzChoose:o==null?void 0:o.onChoose.bind(this)})}render(){var t,e,i,s,n,l,h,o,d,L;return r(S,null,!this.useOnlyRightList&&r("div",{class:"list__container"},this.leftList&&this.renderList({idSortableList:this.LEFT_LIST_ID,list:this.leftList,title:this.leftTitle,isFiltering:this.isFilteringLeft,filteredList:this.leftFilteredList,emptyMessage:!((t=this.emptyMessage)===null||t===void 0)&&t.LEFT_LIST?this.emptyMessage.LEFT_LIST:this.i18n("ez-double-list.noItemsAvailable",{entity:this.entityLabel}),slotConfig:{itemRightSlotBuilder:(i=(e=this.slotsListBuilder)===null||e===void 0?void 0:e.LEFT_LIST)===null||i===void 0?void 0:i.itemRightSlotBuilder,itemLeftSlotBuilder:(n=(s=this.slotsListBuilder)===null||s===void 0?void 0:s.LEFT_LIST)===null||n===void 0?void 0:n.itemLeftSlotBuilder},callbacks:{setRef:a=>this.leftEzListInstance=a,onChange:a=>this.handleChangeLeft(a),onSelect:this.handleSelectLeftItem.bind(this),onDoubleClick:this.handleTransferToRight.bind(this),onChoose:this.handleChooseLeft.bind(this)}})),!this.useOnlyRightList&&r("div",{class:"actions__column"},r("ez-button",{mode:"icon",iconName:"dual-chevron-right",enabled:this.enableTransferAllToRight(),title:this.i18n("ez-double-list.moveAllTo",{list:this.rightListLabel}),size:"small",onClick:this.handleTransferAllToRight.bind(this)}),r("ez-button",{mode:"icon",iconName:"chevron-right",enabled:this.enableTransferToRight(),title:this.i18n("ez-double-list.moveTo",{list:this.rightListLabel}),size:"small",onClick:this.handleTransferToRight.bind(this)}),r("ez-button",{mode:"icon",iconName:"chevron-left",enabled:this.enableTransferToLeft(),title:this.i18n("ez-double-list.moveTo",{list:this.leftListLabel}),size:"small",onClick:this.handleTransferToLeft.bind(this)}),r("ez-button",{mode:"icon",iconName:"dual-chevron-left",enabled:this.enableTransferAllToLeft(),title:this.i18n("ez-double-list.moveAllTo",{list:this.leftListLabel}),size:"small",onClick:this.handleTransferAllToLeft.bind(this)})),r("div",{class:"list__container"},this.rightList&&this.renderList({idSortableList:this.RIGHT_LIST_ID,list:this.rightList,title:this.rightTitle,isFiltering:this.isFilteringRight,filteredList:this.rightFilteredList,emptyMessage:!((l=this.emptyMessage)===null||l===void 0)&&l.RIGHT_LIST?this.emptyMessage.RIGHT_LIST:this.i18n("ez-double-list.noItemsSelected",{entity:this.entityLabel}),slotConfig:{itemRightSlotBuilder:(o=(h=this.slotsListBuilder)===null||h===void 0?void 0:h.RIGHT_LIST)===null||o===void 0?void 0:o.itemRightSlotBuilder,itemLeftSlotBuilder:(L=(d=this.slotsListBuilder)===null||d===void 0?void 0:d.RIGHT_LIST)===null||L===void 0?void 0:L.itemLeftSlotBuilder},callbacks:{setRef:a=>this.rightEzListInstance=a,onChange:a=>this.handleChangeRight(a),onSelect:this.handleSelectRightItem.bind(this),onDoubleClick:this.handleTransferToLeft.bind(this),onChoose:this.handleChooseRight.bind(this)}})),r("div",{class:"actions__column"},r("ez-button",{mode:"icon",iconName:"dual-chevron-up",enabled:this.enableMoveUp(!0),title:this.i18n("ez-double-list.moveToFirstPosition"),size:"small",onClick:this.handleMoveToTop.bind(this)}),r("ez-button",{mode:"icon",iconName:"chevron-up",enabled:this.enableMoveUp(),title:this.i18n("ez-double-list.moveUp"),size:"small",onClick:this.handleMoveUp.bind(this)}),r("ez-button",{mode:"icon",iconName:"chevron-down",enabled:this.enableMoveDown(),title:this.i18n("ez-double-list.moveDown"),size:"small",onClick:this.handleMoveDown.bind(this)}),r("ez-button",{mode:"icon",iconName:"dual-chevron-down",enabled:this.enableMoveDown(!0),title:this.i18n("ez-double-list.moveToLastPosition"),size:"small",onClick:this.handleMoveToBottom.bind(this)})))}static get watchers(){return{leftList:["observeLeftList"],rightList:["observeRightList"]}}};A.style=M;export{A as ez_double_list};
//# sourceMappingURL=ez-double-list.entry-DD4VD86A.js.map

import{b as h,d as p,e as s,k as w,i as v}from"./index-DA6RLjux.js";import{O as b,E as u}from"./dataUnitInMemoryLoader-BjgoPaoq.js";const g=({item:o,hasIcon:e,hasChildren:n,isLockedLevels:i,onSubActionClick:r})=>s("div",{class:"ez-dropdown__item-wrapper",title:o.label},z(o,e),s("span",{class:"ez-dropdown__item-label"},o.label),f(o,n,i,r)),z=(o,e)=>{if(!(o==null||!e))return o.iconName?s("ez-icon",Object.assign({class:"ez-dropdown__icon-left",iconName:o.iconName,size:"medium"},{[u.DATA_ELEMENT_ID_ATTRIBUTE_NAME]:`${o.id}_ezDropdownItemIcon`})):s("ez-icon",{class:"ez-dropdown__icon-left ez-dropdown__hidden",size:"medium"})},f=(o,e,n,i)=>{var r,t;if(o!=null){if(!(!((r=o.children)===null||r===void 0)&&r.length)&&o.subAction!=null&&Object.keys(o.subAction).length>0)return s("span",Object.assign({onClick:()=>i(o),title:o.subAction.label,class:`ez-dropdown__link ez-dropdown__link--${o.subAction.type||"primary"}`},{[u.DATA_ELEMENT_ID_ATTRIBUTE_NAME]:`${o.subAction.id}_ezDropdownItemSubAction`}),o.subAction.label);if(!(n||!e))return((t=o.children)===null||t===void 0?void 0:t.length)>0?s("ez-icon",Object.assign({class:"ez-dropdown__icon-right",iconName:"chevron-right",size:"medium"},{[u.DATA_ELEMENT_ID_ATTRIBUTE_NAME]:`${o.id}_ezDropdownIconOpenChildren`})):s("ez-icon",{class:"ez-dropdown__icon-right ez-dropdown__hidden",size:"medium"})}};class m{constructor(){}show(e){const n=e==null?void 0:e.querySelector(".ez-dropdown__submenu");e==null||n==null||(n.classList.remove("ez-dropdown__submenu--hide"),this.setPosition(e),this.setScrollContainer(e),this.setMaxHeight(n))}hide(e){if(e==null)return;const i=e.querySelector(".ez-dropdown__submenu:not(.ez-dropdown__submenu--hide)");this.reset(i),this.hideChild(i)}hideChild(e){e!=null&&e.querySelectorAll(".ez-dropdown__submenu").forEach(n=>{this.reset(n)})}setPosition(e){const n=e==null?void 0:e.querySelector(".ez-dropdown__submenu"),i=e==null?void 0:e.closest(".ez-dropdown");if(n==null||i==null)return;n.style.top=this.getPositionTop(e),n.style.left=this.getPositionRight(i);const r=n==null?void 0:n.getBoundingClientRect(),t=document.body.clientWidth;(r==null?void 0:r.right)>t&&this.updatePosition(i,n)}setMaxHeight(e){var n;const i=(e==null?void 0:e.shadowRoot)||e,r=i==null?void 0:i.querySelector(".ez-dropdown"),t=document.body.clientHeight;let d,l;if((i==null?void 0:i.tagName)!=null?(d=i,l=d==null?void 0:d.getBoundingClientRect()):l=r==null?void 0:r.getBoundingClientRect(),!(r==null||l==null)){if(l.y+l.height>t)if(d!=null){const a=d.closest(".ez-dropdown"),c=a==null?void 0:a.getBoundingClientRect(),_=parseFloat(((n=getComputedStyle(d))===null||n===void 0?void 0:n.marginTop)||"0");if(a==null||c==null)return;c.y+l.height>t?(d.style.top=c.y-_+"px",r.style.maxHeight=t-c.y+"px"):d.style.top=t-l.height-_+"px"}else{let a=t-l.y;a<0&&(a=l.height-t),r.style.maxHeight=a+"px"}this.setSpacerContainer(r)}}setSpacerContainer(e){const n=e==null?void 0:e.querySelector(".ez-dropdown__container");n!=null&&(n.scrollHeight>n.clientHeight?n.classList.add("ez-dropdown__container--spacer"):n.classList.remove("ez-dropdown__container--spacer"))}reset(e){if(e==null)return;e.classList.add("ez-dropdown__submenu--hide"),e.style.left="",e.style.top="";const n=e.querySelector(".ez-dropdown");this.resetDropdown(n)}resetDropdown(e){e!=null&&(e.style.maxHeight="",this.setSpacerContainer(e))}setScrollContainer(e){const n=e==null?void 0:e.closest(".ez-dropdown__container");n!=null&&(n.onscroll=this.onScrollContainer.bind(this))}onScrollContainer(e){const n=e==null?void 0:e.target;this.hideChild(n)}getPositionTop(e){const n=e==null?void 0:e.getBoundingClientRect();if(n!=null)return n.y+"px"}getPositionRight(e){const n=e==null?void 0:e.getBoundingClientRect();if(n!=null)return n.x+n.width+"px"}getPositionLeft(e,n){const i=e==null?void 0:e.getBoundingClientRect(),r=n==null?void 0:n.getBoundingClientRect();if(!(i==null||r==null))return i.x-r.width+"px"}updatePosition(e,n){const i=e==null?void 0:e.getBoundingClientRect(),r=n==null?void 0:n.getBoundingClientRect();i==null||r==null||i.x<r.right&&(n.style.left=this.getPositionLeft(e,n),this.updatePosition(e,n))}}const x=":host{--ez-dropdown--z-index:var(--more-visible, 2);--ez-dropdown--padding:var(--space--small, 6px);--ez-dropdown--box-shadow:var(--shadow--medium, 0px 8px 24px rgba(0, 38, 111, 0.1));--ez-dropdown--border-radius:var(--border--radius-medium, 12px);--ez-dropdown--background-color:var(--background--xlight, #fff);--ez-dropdown--font-family:var(--font-pattern, 'Roboto');--ez-dropdown--max-height:415px;--ez-dropdown__item--padding:var(--space--small, 6px);--ez-dropdown__item--gap:var(--space--small, 6px);--ez-dropdown__item--border-radius:var(--border--radius-small, 6px);--ez-dropdown__item--color:var(--title--primary, #2b3a54);--ez-dropdown__item--font-weight:var(--text-weight--medium, 400);--ez-dropdown__item--font-size:var(--text--medium, 14px);--ez-dropdown__item--line-height:calc(var(--ez-dropdown__item--font-size) + 4px);--ez-dropdown__item--background-color:var(--background--medium, #f0f3f7);--ez-dropdown__item--transition:var(--transition, .2s linear);--ez-dropdown__item-label--margin-right:var(--space--medium, 12px);--ez-dropdown__icon--size:var(--icon--medium, 18px);--ez-dropdown__divider--background-color:var(--color--disable-secondary, #f2f5f8);--ez-dropdown__divider--margin:var(--space--extra-small, 3px) 0;--ez-dropdown__group-label--color:var(--text--secondary, #A2ABB9);--ez-dropdown__group-label--font-weight:var(--text-weight--large, 600);--ez-dropdown__group-label--font-size:var(--text--small, 12px);--ez-dropdown__group-label--line-height:var(--text--medium, 14px);--ez-dropdown__group-label--padding:var(--space--small, 6px);--ez-dropdown__submenu--z-index:var(--most-visible, 3);--ez-dropdown__link--font-weight:var(--text-weight--large, 600);--ez-dropdown__link--primary--color:var(--color--primary, #008561);--ez-dropdown__link--critical--color:var(--color-alert--error-800, #BD0025);--ez-dropdown__scrollbar--color-default:var(--scrollbar--default, #626e82);--ez-dropdown__scrollbar--color-background:var(--scrollbar--background, #E5EAF0);--ez-dropdown__scrollbar--color-hover:var(--scrollbar--hover, #2B3A54);--ez-dropdown__scrollbar--color-clicked:var(--scrollbar--clicked, #a2abb9);--ez-dropdown__scrollbar--border-radius:var(--border--radius-small, 6px);--ez-dropdown__scrollbar--width:var(--space--small, 6px);--ez-dropdown__scrollbar--padding-right:var(--space--extra-small, 3px);display:flex;flex-direction:column;height:fit-content;user-select:none;box-sizing:border-box;position:fixed;z-index:var(--ez-dropdown--z-index)}:host *{box-sizing:border-box}.ez-dropdown{display:flex;padding:var(--ez-dropdown--padding);box-shadow:var(--ez-dropdown--box-shadow);border-radius:var(--ez-dropdown--border-radius);background-color:var(--ez-dropdown--background-color);max-width:var(--ez-dropdown--max-width)}.ez-dropdown__max-height{max-height:var(--ez-dropdown--max-height)}.ez-dropdown *{font-family:var(--ez-dropdown--font-family)}.ez-dropdown__container{display:flex;flex-direction:column;overflow-y:auto;scrollbar-width:thin;flex:auto;scrollbar-color:var(--ez-dropdown__scrollbar--color-clicked) var(--ez-dropdown__scrollbar--color-background)}.ez-dropdown__container::-webkit-scrollbar{background-color:var(--ez-dropdown__scrollbar--color-background);width:var(--ez-dropdown__scrollbar--width);max-width:var(--ez-dropdown__scrollbar--width);min-width:var(--ez-dropdown__scrollbar--width)}.ez-dropdown__container::-webkit-scrollbar-track{background-color:var(--ez-dropdown__scrollbar--color-background);border-radius:var(--ez-dropdown__scrollbar--border-radius)}.ez-dropdown__container::-webkit-scrollbar-thumb{background-color:var(--ez-dropdown__scrollbar--color-default);border-radius:var(--ez-dropdown__scrollbar--border-radius)}.ez-dropdown__container::-webkit-scrollbar-thumb:vertical:hover,.ez-dropdown__container::-webkit-scrollbar-thumb:horizontal:hover{background-color:var(--ez-dropdown__scrollbar--color-hover)}.ez-dropdown__container::-webkit-scrollbar-thumb:vertical:active,.ez-dropdown__container::-webkit-scrollbar-thumb:horizontal:active{background-color:var(--ez-dropdown__scrollbar--color-clicked)}.ez-dropdown__container--spacer{padding-right:var(--ez-dropdown__scrollbar--padding-right)}.ez-dropdown__item{display:flex;align-items:center;background-color:transparent;border-radius:var(--ez-dropdown__item--border-radius);transition:var(--ez-dropdown__item--transition)}.ez-dropdown__item:hover{background-color:var(--ez-dropdown__item--background-color)}.ez-dropdown__item-wrapper{display:flex;align-items:center;position:relative;cursor:pointer;width:100%;margin:0;white-space:nowrap;gap:var(--ez-dropdown__item--gap);color:var(--ez-dropdown__item--color);font-weight:var(--ez-dropdown__item--font-weight);font-size:var(--ez-dropdown__item--font-size);line-height:var(--ez-dropdown__item--line-height);padding:var(--ez-dropdown__item--padding)}.ez-dropdown__item-wrapper ez-icon{display:flex;justify-content:center;align-items:center;width:var(--ez-dropdown__icon--size);height:var(--ez-dropdown__icon--size);min-width:var(--ez-dropdown__icon--size);min-height:var(--ez-dropdown__icon--size)}.ez-dropdown__item-content{display:flex;align-items:center;flex:auto;overflow:hidden;gap:var(--ez-dropdown__item--gap)}.ez-dropdown__item-label{text-align:left;text-overflow:ellipsis;overflow:hidden;flex:auto}.ez-dropdown__item-label:not(:last-child){margin-right:var(--ez-dropdown__item-label--margin-right)}.ez-dropdown__item-content+.ez-dropdown__link{margin-left:var(--ez-dropdown__item-label--margin-right);margin-right:var(--ez-dropdown__item--padding)}.ez-dropdown__item-builder{flex:auto}.ez-dropdown__divider{width:100%;height:2px;border-radius:1px;border:none;display:block;background-color:var(--ez-dropdown__divider--background-color);margin:var(--ez-dropdown__divider--margin)}.ez-dropdown__hidden{visibility:hidden}.ez-dropdown__group{display:flex;flex-direction:column}.ez-dropdown__group-label{display:block;width:100%;text-align:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:var(--ez-dropdown__group-label--color);font-weight:var(--ez-dropdown__group-label--font-weight);font-size:var(--ez-dropdown__group-label--font-size);line-height:var(--ez-dropdown__group-label--line-height);padding:var(--ez-dropdown__group-label--padding)}.ez-dropdown__icon-right{margin-left:auto}.ez-dropdown__submenu{position:fixed;z-index:var(--ez-dropdown__submenu--z-index);margin-top:calc(var(--ez-dropdown__item--padding) * -1)}.ez-dropdown__submenu--hide{display:none}.ez-dropdown__link{display:block;margin-left:auto;cursor:pointer;text-overflow:ellipsis;overflow:hidden;font-weight:var(--ez-dropdown__link--font-weight);max-width:calc(var(--ez-dropdown--max-width) * 0.43)}.ez-dropdown__link--primary{color:var(--ez-dropdown__link--primary--color)}.ez-dropdown__link--critical{color:var(--ez-dropdown__link--critical--color)}.ez-dropdown__link:hover{text-decoration:underline}",k=class{constructor(o){h(this,o),this.ezClick=p(this,"ezClick"),this.ezSubActionClick=p(this,"ezSubActionClick"),this.ezOutsideClick=p(this,"ezOutsideClick"),this.ezHover=p(this,"ezHover"),this._itemList={},this._submenuList=[],this._openedMenuList={},this._levelLimits=3,this.items=[],this.value=void 0,this.itemBuilder=void 0}handleClickOutside(o){this._element.contains(o.target)||this.ezOutsideClick.emit()}defaultItemBuilder(o,e,n,i){return s(g,{item:o,hasIcon:n,hasChildren:i,isLockedLevels:e,onSubActionClick:this.onSubActionClick.bind(this)})}getMaxOrder(o){return o==null||o.length===0?-1:Math.max(...o.map(e=>{var n;const i=(n=e.group)===null||n===void 0?void 0:n.order;return i!=null&&i>=0?i:-1}))}hasIcon(o){return o==null?void 0:o.some(e=>(e.iconName||"")!=="")}hasGroup(o){return o==null?void 0:o.some(e=>(e.group||"")!=="")}hasChildren(o){return o==null?void 0:o.some(e=>(e.children||[]).length>0)}isLockedLevels(o){return this._levelLimits?o===this._levelLimits+1:!1}getItemsByGroup(o,e){let n={};const i=this.getMaxOrder(o);return o.forEach(r=>{const t=r.group&&r.group.label!=null?r.group.label||"noGroup":r.group||"noGroup",d=r.group&&r.group.order!=null?r.group.order:r.group?i+1:i+2;let l=n[t];l==null&&(l={items:[],order:d}),this.validateItem(r,e),l.items.push(r),n[t]=l}),b.sortByProperty(n,"order")}validateItem(o,e){if(this._itemList==null&&(this._itemList={}),o.type==null&&(o.type="item"),o.id==null){const n=`level_${e}_${o.type}`,i=Object.keys(this._itemList).filter(r=>r.includes(n)).length;o.id=`${n}_${i+1}`}if(o.label==null&&(o.label=""),o.subAction!=null){if(o.subAction.id==null){const n=`subAction_${o.id}`;o.subAction.id=n}o.subAction.label==null&&(o.subAction.label="")}this._itemList[o.id]==null&&(this._itemList[o.id]={})}getContainerItemBuilder(o,e,n,i,r){if(this.itemBuilder==null)return;const t=this.itemBuilder(o,e);return t==null?this.defaultItemBuilder(o,n,i,r):typeof t!="string"?s("div",{class:"ez-dropdown__item-builder"},t):s("div",{class:"ez-dropdown__item-builder",innerHTML:t})}getItemsRender(o,e,n,i){if(o==null)return;let r=e,t=!1;return i&&(r++,t=this.isLockedLevels(r)),o.map(d=>{var l;switch(d.type){case"loading":return s("div",{class:"ez-dropdown__item"},s("ez-skeleton",{width:"200px"}));case"divider":return s("hr",Object.assign({class:"ez-dropdown__divider"},{[u.DATA_ELEMENT_ID_ATTRIBUTE_NAME]:u.getInternalIDInfo(`${d.id}_ezDropdownDivider`)}));default:return s("div",Object.assign({ref:a=>this._itemList[d.id]=a,class:"ez-dropdown__item","data-level":e},{[u.DATA_ELEMENT_ID_ATTRIBUTE_NAME]:u.getInternalIDInfo(`${d.id}_ezDropdownItem`)}),s("div",{class:"ez-dropdown__item-content",onClick:a=>this.onItemClick(a,d),onMouseOver:a=>this.onShowSubmenu(a,d),onMouseEnter:()=>this.ezHover.emit(d)},this.itemBuilder?this.getContainerItemBuilder(d,e,t,n,i):this.defaultItemBuilder(d,t,n,i)),((l=d.children)===null||l===void 0?void 0:l.length)>0&&!t&&i&&s("div",{ref:a=>this._submenuList.push(a),class:"ez-dropdown__submenu ez-dropdown__submenu--hide"},this.renderDropdown(d.children,r)))}})}renderDropdown(o=this.items,e=1){if(o==null||this.isLockedLevels(e))return;const n=this.getItemsByGroup(o,e),i=this.hasGroup(o),r=this.hasIcon(o),t=this.hasChildren(o);return s("div",{class:"ez-dropdown ez-dropdown__max-height","data-level":e},s("div",{class:"ez-dropdown__container"},Object.keys(n).map(d=>s("div",Object.assign({class:"ez-dropdown__group"},{[u.DATA_ELEMENT_ID_ATTRIBUTE_NAME]:u.getInternalIDInfo(`${d}_ezDropdownGroup`)}),d!=="noGroup"&&s("label",{class:"ez-dropdown__group-label",title:d},d),i&&d==="noGroup"&&s("hr",Object.assign({class:"ez-dropdown__divider"},{[u.DATA_ELEMENT_ID_ATTRIBUTE_NAME]:u.getInternalIDInfo(`${d}_ezDropdownDivider`)})),this.getItemsRender(n[d].items,e,r,t)))))}hasOpenedSubmenu(o){const e=Object.keys(this._openedMenuList);return e.includes(o.toString())||e.some(n=>Number(n)>o)}hasSubmenuOpened(){var o;return(o=this._submenuList)===null||o===void 0?void 0:o.some(e=>!e.classList.contains("ez-dropdown__submenu--hide"))}setEvents(){document.removeEventListener("click",this.onHideAllSubmenu.bind(this)),document.addEventListener("click",this.onHideAllSubmenu.bind(this)),document.removeEventListener("scroll",this.onSubmenuReposition.bind(this)),document.addEventListener("scroll",this.onSubmenuReposition.bind(this))}onShowSubmenu(o,e){var n;if(o==null)return;const i=this._itemList[e.id];if(!(i!=null&&i.classList.contains("ez-dropdown__item")))return;const r=Number(i.dataset.level||"0");this.hasOpenedSubmenu(r)&&(this._submenuControl.hide(this._openedMenuList[r]),delete this._openedMenuList[r]),!((n=e.children)===null||n===void 0)&&n.length&&(this._openedMenuList[i.dataset.level]=i,this._submenuControl.show(i))}onItemClick(o,e){const n=o==null?void 0:o.target;n!=null&&n.classList.contains("ez-dropdown__link")||(this.value=e,this.ezClick.emit(e))}onSubActionClick(o){this.ezSubActionClick.emit(o.subAction)}onHideAllSubmenu(o=void 0){const e=o==null?void 0:o.target;this.hasSubmenuOpened()&&(e==null||!e.closest(".ez-dropdown")&&e.tagName!=="EZ-DROPDOWN")&&(this._openedMenuList={},this._submenuList.forEach(this._submenuControl.reset.bind(this._submenuControl)))}onSubmenuReposition(){this._openedMenuList!=null&&Object.keys(this._openedMenuList).forEach(o=>{const e=this._openedMenuList[o];this._submenuControl.setPosition(e)})}componentDidLoad(){u.addIDInfo(this._element),this._submenuControl=new m,this._submenuControl.setMaxHeight(this._element)}componentDidUpdate(){this._submenuControl.setMaxHeight(this._element)}componentDidRender(){this.setEvents()}render(){return s(w,null,this.renderDropdown())}get _element(){return v(this)}};k.style=x;export{k as ez_dropdown};

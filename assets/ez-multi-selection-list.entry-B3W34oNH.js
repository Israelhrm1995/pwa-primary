import{b as u,d,e as n,l as p,k as O}from"./index-CHe-Tgi3.js";import{g as h}from"./dataUnitInMemoryLoader-CwDmnNwL.js";const S=".sc-ez-multi-selection-list-h{--ez-check--outter-gap:0px;--ez-multi-selection-default-height:322px;display:block;width:304px;height:var(--ez-multi-selection-default-height);min-height:fit-content;max-height:calc(100vh - 350px)}.multi-selection__input.sc-ez-multi-selection-list{margin-bottom:var(--space--2xs, 8px)}.multi-selection__content-options.sc-ez-multi-selection-list{position:relative;left:-4px}.multi-selection__select-all.sc-ez-multi-selection-list{height:var(--space--xl);margin:0 var(--space--small, 6px)}.multi-selection__list.sc-ez-multi-selection-list{max-height:calc(100vh - 435px);overflow-y:auto;overflow-x:clip}.multi-selection__list.sc-ez-multi-selection-list::-webkit-scrollbar{width:var(--space--small);min-width:var(--space--small);max-width:var(--space--small)}";var s;(function(e){e.DATASOURCE_RESULTS="DATASOURCE_RESULTS",e.DATASOURCE_RESULTS_EMPTY="DATASOURCE_RESULTS_EMPTY",e.DATASOURCE_INIT="DATASOURCE_INIT",e.OPTIONS_EMPTY="OPTIONS_EMPTY",e.OPTIONS="OPTIONS"})(s||(s={}));const m=class{constructor(e){u(this,e),this.changeFilteredOptions=d(this,"changeFilteredOptions"),this.columnName=void 0,this.dataSource=void 0,this.useOptions=!1,this.options=void 0,this.isTextSearch=!1,this.filteredOptions=void 0,this.displayOptions=void 0,this.viewScenario=void 0,this.displayOptionToCheckAllItems=!0}async clearFilteredOptions(){this.setInitialScenario(),this.filteredOptions=[],this.searchInput&&(this.searchInput.value=""),this.filterInput&&(this.filterInput.value="")}onChangeUseOptions(){this.setInitialScenario()}onChangeOptions(){this.options&&(this.filteredOptions=this.ordenationByCheckStateAndAlphabetically(this.options)),this.checkInput&&this.changeCheckAllValeuFromFilteredOptions(),this.setInitialScenario()}onChangeFilteredOptions(e){this.displayOptions=this.filteredOptions,this.displayOptionToCheckAllItems=this.filteredOptions.length>1,this.checkInput&&this.changeCheckAllValeuFromFilteredOptions(),this.changeFilteredOptions.emit(e)}componentDidRender(){this.changeCheckAllValeuFromFilteredOptions()}ordenationByCheckStateAndAlphabetically(e){const t=[],i=[];let l;return e.forEach(a=>{a.value==null||a.label===""?l=Object.assign(Object.assign({},a),{label:"(Vazio)"}):a.check?t.push(a):i.push(a)}),(l==null?[]:[l]).concat(this.dataSource==null?h.sortAlphabetically(t):this.dataSource.sortItems(this.columnName,t)).concat(this.dataSource==null?h.sortAlphabetically(i):this.dataSource.sortItems(this.columnName,i))}changeCheckAllValeuFromFilteredOptions(){var e,t,i,l;const a=(e=this.filteredOptions)===null||e===void 0?void 0:e.every(o=>o.check===!0),c=(t=this.filteredOptions)===null||t===void 0?void 0:t.every(o=>o.check===!1),r=((i=this.filteredOptions)===null||i===void 0?void 0:i.some(o=>o.check===!1))&&((l=this.filteredOptions)===null||l===void 0?void 0:l.some(o=>o.check===!0))&&(!a||!c);if(this.checkInput&&a){this.checkInput.indeterminate=!1,this.checkInput.value=!0;return}if(this.checkInput&&r){this.checkInput.indeterminate=!0,this.checkInput.value=!1;return}if(this.checkInput&&c){this.checkInput.indeterminate=!1,this.checkInput.value=!1;return}}setInitialScenario(){if(this.useOptions){this.viewScenario=s.OPTIONS,this.changeCheckAllValeuFromFilteredOptions();return}this.viewScenario=this.options&&this.options.length>0?s.DATASOURCE_RESULTS:s.DATASOURCE_INIT}async searchWithDataSource(e,t){const{argument:i,mode:l}=e;if(l!=="PRELOAD"&&t)return this.dataSource.fetchData(i,t)}handleSearchOnDataSource(e){var t;const i=(t=this.filteredOptions)!==null&&t!==void 0?t:[];e.detail&&!i.some(l=>l.value==e.detail.value)&&(this.filteredOptions=this.ordenationByCheckStateAndAlphabetically([...i,e.detail])),this.viewScenario=s.DATASOURCE_RESULTS,this.searchInput.value=""}handleRemoveItemFromOptions(e){this.filteredOptions=this.ordenationByCheckStateAndAlphabetically(this.filteredOptions.filter(t=>t.value!==e.value)),this.filteredOptions.length===0&&(this.viewScenario=s.DATASOURCE_INIT),this.searchInput&&(this.searchInput.value="")}handleSearchOnOption(e){if(e.detail){this.displayOptions=h.applyStringFilter(e.detail,this.filteredOptions,!0),this.viewScenario=this.displayOptions.length===0?s.OPTIONS_EMPTY:s.OPTIONS;return}this.displayOptions=this.filteredOptions,this.viewScenario=s.OPTIONS}handleChangeSelectAllItems(e){this.filteredOptions=this.ordenationByCheckStateAndAlphabetically([...this.filteredOptions.map(t=>(t.check=!!e.detail,t))])}handleChangeSelectedItem(e){const{detail:t}=e,i=this.filteredOptions.find(l=>l.label===t.label);i.check=t.check}buildViewList(e){return n(p,null,this.displayOptionToCheckAllItems&&n("ez-check",{ref:t=>this.checkInput=t,label:"Selecionar todos",class:"multi-selection__select-all",onEzChange:this.handleChangeSelectAllItems.bind(this)}),n("ez-list",{class:"multi-selection__list",dataSource:this.displayOptions,listMode:"check",hoverFeedback:!0,onEzCheckChange:this.handleChangeSelectedItem.bind(this),itemSlotBuilder:e?this.buildDeleteIconSlot.bind(this):null}))}buildDeleteIconSlot(e){return n("ez-icon",{style:{cursor:"pointer"},iconName:"delete",onClick:()=>this.handleRemoveItemFromOptions(e)})}buildInitViewWithDataSource(){return n("multi-selection-box-message",{message:"Selecione os valores a serem filtrados atravÃ©s do campo de busca."})}buildViewEmptyResults(){return n("multi-selection-box-message",{message:"Nenhum resultado encontrado."})}scenarioToDisplay(e){const i={[s.DATASOURCE_INIT]:()=>this.buildInitViewWithDataSource(),[s.DATASOURCE_RESULTS]:()=>this.buildViewList(!0),[s.DATASOURCE_RESULTS_EMPTY]:()=>this.buildViewEmptyResults(),[s.OPTIONS_EMPTY]:()=>this.buildViewEmptyResults(),[s.OPTIONS]:()=>this.buildViewList(!1)}[e];return i?i():void 0}render(){return n(O,null,n("div",{class:"multi-selection"},this.useOptions?n("ez-filter-input",{ref:e=>this.filterInput=e,label:"Buscar..",onEzChange:this.handleSearchOnOption.bind(this)}):n("ez-search",{class:"multi-selection__input",label:"Buscar...",ref:e=>this.searchInput=e,suppressEmptyOption:!0,showOptionValue:!1,showSelectedValue:!1,optionLoader:e=>this.searchWithDataSource(e,this.columnName),onEzChange:this.handleSearchOnDataSource.bind(this),isTextSearch:this.isTextSearch}),n("ez-scroll",{class:"multi-selection__content-options"},this.scenarioToDisplay(this.viewScenario))))}static get watchers(){return{useOptions:["onChangeUseOptions"],options:["onChangeOptions"],filteredOptions:["onChangeFilteredOptions"]}}};m.style=S;export{m as ez_multi_selection_list};
//# sourceMappingURL=ez-multi-selection-list.entry-B3W34oNH.js.map

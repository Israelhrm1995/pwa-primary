import{b as _,d as P,e as D,k as x,i as C}from"./index-CzwKln6B.js";import{S as L}from"./dataUnitInMemoryLoader-CwDmnNwL.js";var f=function(e,t){return Number(e.slice(0,-1*t.length))},I=function(e){return e.endsWith("px")?{value:e,type:"px",numeric:f(e,"px")}:e.endsWith("fr")?{value:e,type:"fr",numeric:f(e,"fr")}:e.endsWith("%")?{value:e,type:"%",numeric:f(e,"%")}:e==="auto"?{value:e,type:"auto"}:null},S=function(e){return e.split(" ").map(I)},M=function(e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var s=i?e+1:e,o=t.slice(0,s).reduce(function(u,h){return u+h.numeric},0),l=r?e*r:0;return o+l},k=function(e,t,r){return t.concat(r).map(function(i){return i.style[e]}).filter(function(i){return i!==void 0&&i!==""})},R=function(e,t){return t.endsWith(e)?Number(t.slice(0,-1*e.length)):null},w=function(e){for(var t=0;t<e.length;t++)if(e[t].numeric>0)return t;return null},c=function(){return!1},A=function(e,t,r){e.style[t]=r},n=function(e,t,r){var i=e[t];return i!==void 0?i:r};function G(e){var t;return(t=[]).concat.apply(t,Array.from(e.ownerDocument.styleSheets).map(function(r){var i=[];try{i=Array.from(r.cssRules||[])}catch{}return i})).filter(function(r){var i=!1;try{i=e.matches(r.selectorText)}catch{}return i})}var N="grid-template-columns",$="grid-template-rows",a=function(t,r,i){this.direction=t,this.element=r.element,this.track=r.track,t==="column"?(this.gridTemplateProp=N,this.gridGapProp="grid-column-gap",this.cursor=n(i,"columnCursor",n(i,"cursor","col-resize")),this.snapOffset=n(i,"columnSnapOffset",n(i,"snapOffset",30)),this.dragInterval=n(i,"columnDragInterval",n(i,"dragInterval",1)),this.clientAxis="clientX",this.optionStyle=n(i,"gridTemplateColumns")):t==="row"&&(this.gridTemplateProp=$,this.gridGapProp="grid-row-gap",this.cursor=n(i,"rowCursor",n(i,"cursor","row-resize")),this.snapOffset=n(i,"rowSnapOffset",n(i,"snapOffset",30)),this.dragInterval=n(i,"rowDragInterval",n(i,"dragInterval",1)),this.clientAxis="clientY",this.optionStyle=n(i,"gridTemplateRows")),this.onDragStart=n(i,"onDragStart",c),this.onDragEnd=n(i,"onDragEnd",c),this.onDrag=n(i,"onDrag",c),this.writeStyle=n(i,"writeStyle",A),this.startDragging=this.startDragging.bind(this),this.stopDragging=this.stopDragging.bind(this),this.drag=this.drag.bind(this),this.minSizeStart=r.minSizeStart,this.minSizeEnd=r.minSizeEnd,r.element&&(this.element.addEventListener("mousedown",this.startDragging),this.element.addEventListener("touchstart",this.startDragging))};a.prototype.getDimensions=function(){var t=this.grid.getBoundingClientRect(),r=t.width,i=t.height,s=t.top,o=t.bottom,l=t.left,u=t.right;this.direction==="column"?(this.start=s,this.end=o,this.size=i):this.direction==="row"&&(this.start=l,this.end=u,this.size=r)};a.prototype.getSizeAtTrack=function(t,r){return M(t,this.computedPixels,this.computedGapPixels,r)};a.prototype.getSizeOfTrack=function(t){return this.computedPixels[t].numeric};a.prototype.getRawTracks=function(){var t=k(this.gridTemplateProp,[this.grid],G(this.grid));if(!t.length){if(this.optionStyle)return this.optionStyle;throw Error("Unable to determine grid template tracks from styles.")}return t[0]};a.prototype.getGap=function(){var t=k(this.gridGapProp,[this.grid],G(this.grid));return t.length?t[0]:null};a.prototype.getRawComputedTracks=function(){return window.getComputedStyle(this.grid)[this.gridTemplateProp]};a.prototype.getRawComputedGap=function(){return window.getComputedStyle(this.grid)[this.gridGapProp]};a.prototype.setTracks=function(t){this.tracks=t.split(" "),this.trackValues=S(t)};a.prototype.setComputedTracks=function(t){this.computedTracks=t.split(" "),this.computedPixels=S(t)};a.prototype.setGap=function(t){this.gap=t};a.prototype.setComputedGap=function(t){this.computedGap=t,this.computedGapPixels=R("px",this.computedGap)||0};a.prototype.getMousePosition=function(t){return"touches"in t?t.touches[0][this.clientAxis]:t[this.clientAxis]};a.prototype.startDragging=function(t){if(!("button"in t&&t.button!==0)){t.preventDefault(),this.element?this.grid=this.element.parentNode:this.grid=t.target.parentNode,this.getDimensions(),this.setTracks(this.getRawTracks()),this.setComputedTracks(this.getRawComputedTracks()),this.setGap(this.getGap()),this.setComputedGap(this.getRawComputedGap());var r=this.trackValues.filter(function(u){return u.type==="%"}),i=this.trackValues.filter(function(u){return u.type==="fr"});if(this.totalFrs=i.length,this.totalFrs){var s=w(i);s!==null&&(this.frToPixels=this.computedPixels[s].numeric/i[s].numeric)}if(r.length){var o=w(r);o!==null&&(this.percentageToPixels=this.computedPixels[o].numeric/r[o].numeric)}var l=this.getSizeAtTrack(this.track,!1)+this.start;if(this.dragStartOffset=this.getMousePosition(t)-l,this.aTrack=this.track-1,this.track<this.tracks.length-1)this.bTrack=this.track+1;else throw Error("Invalid track index: "+this.track+". Track must be between two other tracks and only "+this.tracks.length+" tracks were found.");this.aTrackStart=this.getSizeAtTrack(this.aTrack,!1)+this.start,this.bTrackEnd=this.getSizeAtTrack(this.bTrack,!0)+this.start,this.dragging=!0,window.addEventListener("mouseup",this.stopDragging),window.addEventListener("touchend",this.stopDragging),window.addEventListener("touchcancel",this.stopDragging),window.addEventListener("mousemove",this.drag),window.addEventListener("touchmove",this.drag),this.grid.addEventListener("selectstart",c),this.grid.addEventListener("dragstart",c),this.grid.style.userSelect="none",this.grid.style.webkitUserSelect="none",this.grid.style.MozUserSelect="none",this.grid.style.pointerEvents="none",this.grid.style.cursor=this.cursor,window.document.body.style.cursor=this.cursor,this.onDragStart(this.direction,this.track)}};a.prototype.stopDragging=function(){this.dragging=!1,this.cleanup(),this.onDragEnd(this.direction,this.track),this.needsDestroy&&(this.element&&(this.element.removeEventListener("mousedown",this.startDragging),this.element.removeEventListener("touchstart",this.startDragging)),this.destroyCb(),this.needsDestroy=!1,this.destroyCb=null)};a.prototype.drag=function(t){var r=this.getMousePosition(t),i=this.getSizeOfTrack(this.track),s=this.aTrackStart+this.minSizeStart+this.dragStartOffset+this.computedGapPixels,o=this.bTrackEnd-this.minSizeEnd-this.computedGapPixels-(i-this.dragStartOffset),l=s+this.snapOffset,u=o-this.snapOffset;r<l&&(r=s),r>u&&(r=o),r<s?r=s:r>o&&(r=o);var h=r-this.aTrackStart-this.dragStartOffset-this.computedGapPixels,g=this.bTrackEnd-r+this.dragStartOffset-i-this.computedGapPixels;if(this.dragInterval>1){var p=Math.round(h/this.dragInterval)*this.dragInterval;g-=p-h,h=p}if(h<this.minSizeStart&&(h=this.minSizeStart),g<this.minSizeEnd&&(g=this.minSizeEnd),this.trackValues[this.aTrack].type==="px")this.tracks[this.aTrack]=h+"px";else if(this.trackValues[this.aTrack].type==="fr")if(this.totalFrs===1)this.tracks[this.aTrack]="1fr";else{var T=h/this.frToPixels;this.tracks[this.aTrack]=T+"fr"}else if(this.trackValues[this.aTrack].type==="%"){var b=h/this.percentageToPixels;this.tracks[this.aTrack]=b+"%"}if(this.trackValues[this.bTrack].type==="px")this.tracks[this.bTrack]=g+"px";else if(this.trackValues[this.bTrack].type==="fr")if(this.totalFrs===1)this.tracks[this.bTrack]="1fr";else{var E=g/this.frToPixels;this.tracks[this.bTrack]=E+"fr"}else if(this.trackValues[this.bTrack].type==="%"){var z=g/this.percentageToPixels;this.tracks[this.bTrack]=z+"%"}var v=this.tracks.join(" ");this.writeStyle(this.grid,this.gridTemplateProp,v),this.onDrag(this.direction,this.track,v)};a.prototype.cleanup=function(){window.removeEventListener("mouseup",this.stopDragging),window.removeEventListener("touchend",this.stopDragging),window.removeEventListener("touchcancel",this.stopDragging),window.removeEventListener("mousemove",this.drag),window.removeEventListener("touchmove",this.drag),this.grid&&(this.grid.removeEventListener("selectstart",c),this.grid.removeEventListener("dragstart",c),this.grid.style.userSelect="",this.grid.style.webkitUserSelect="",this.grid.style.MozUserSelect="",this.grid.style.pointerEvents="",this.grid.style.cursor=""),window.document.body.style.cursor=""};a.prototype.destroy=function(t,r){t===void 0&&(t=!0),t||this.dragging===!1?(this.cleanup(),this.element&&(this.element.removeEventListener("mousedown",this.startDragging),this.element.removeEventListener("touchstart",this.startDragging)),r&&r()):(this.needsDestroy=!0,r&&(this.destroyCb=r))};var y=function(e,t,r){return t in e?e[t]:r},m=function(e,t){return function(r){if(r.track<1)throw Error("Invalid track index: "+r.track+". Track must be between two other tracks.");var i=e==="column"?t.columnMinSizes||{}:t.rowMinSizes||{},s=e==="column"?"columnMinSize":"rowMinSize";return new a(e,Object.assign({},{minSizeStart:y(i,r.track-1,n(t,s,n(t,"minSize",0))),minSizeEnd:y(i,r.track+1,n(t,s,n(t,"minSize",0)))},r),t)}},d=function(t){var r=this;this.columnGutters={},this.rowGutters={},this.options=Object.assign({},{columnGutters:t.columnGutters||[],rowGutters:t.rowGutters||[],columnMinSizes:t.columnMinSizes||{},rowMinSizes:t.rowMinSizes||{}},t),this.options.columnGutters.forEach(function(i){r.columnGutters[i.track]=m("column",r.options)(i)}),this.options.rowGutters.forEach(function(i){r.rowGutters[i.track]=m("row",r.options)(i)})};d.prototype.addColumnGutter=function(t,r){this.columnGutters[r]&&this.columnGutters[r].destroy(),this.columnGutters[r]=m("column",this.options)({element:t,track:r})};d.prototype.addRowGutter=function(t,r){this.rowGutters[r]&&this.rowGutters[r].destroy(),this.rowGutters[r]=m("row",this.options)({element:t,track:r})};d.prototype.removeColumnGutter=function(t,r){var i=this;r===void 0&&(r=!0),this.columnGutters[t]&&this.columnGutters[t].destroy(r,function(){delete i.columnGutters[t]})};d.prototype.removeRowGutter=function(t,r){var i=this;r===void 0&&(r=!0),this.rowGutters[t]&&this.rowGutters[t].destroy(r,function(){delete i.rowGutters[t]})};d.prototype.handleDragStart=function(t,r,i){r==="column"?(this.columnGutters[i]&&this.columnGutters[i].destroy(),this.columnGutters[i]=m("column",this.options)({track:i}),this.columnGutters[i].startDragging(t)):r==="row"&&(this.rowGutters[i]&&this.rowGutters[i].destroy(),this.rowGutters[i]=m("row",this.options)({track:i}),this.rowGutters[i].startDragging(t))};d.prototype.destroy=function(t){var r=this;t===void 0&&(t=!0),Object.keys(this.columnGutters).forEach(function(i){return r.columnGutters[i].destroy(t,function(){delete r.columnGutters[i]})}),Object.keys(this.rowGutters).forEach(function(i){return r.rowGutters[i].destroy(t,function(){delete r.rowGutters[i]})})};function U(e){return new d(e)}const V=".ez-split-gutter{cursor:grab;background-color:transparent;max-width:100%}.ez-split-gutter__row{cursor:ns-resize}.ez-split-gutter__column{cursor:ew-resize}.structural__panel{background:none;box-shadow:none;outline:none;padding:0;margin:0;border:0}",F=class{constructor(e){_(this,e),this.resizeEnd=P(this,"resizeEnd"),this._items=[],this._buildInProgress=!1,this.direction="column",this.anchorToExpand=!1,this.structural=!1}rebuildLayout(){Array.from(this._element.querySelectorAll(".ez-split-gutter")).reverse().forEach(e=>{e.remove()}),Array.from(this._element.getElementsByTagName("EzSplitPanel")).reverse().forEach(e=>{e.rebuildLayout()}),this.buildItems(),this.initSplit()}buildItems(){this._panelID=L.generateUUID(),this._element.dataset.panelId=this._panelID,this._element.dataset.uniqueId="EzSplitPanel";let e=Array.from(this._element.children);this._items=e.filter(r=>{var i;return((i=r.tagName)===null||i===void 0?void 0:i.toUpperCase())==="EZ-SPLIT-ITEM"});let t=1;this._items.forEach((r,i)=>{r.dataset.trackNumber=t.toString(),this._items.length>1&&i!=this._items.length-1&&this.addItemGutter(r),t+=2})}componentDidLoad(){this.buildItems(),this.initSplit(),this._mutationObserver=new MutationObserver(e=>{for(const t of e)if(t.type==="childList"&&!this._buildInProgress){this._buildInProgress=!0,window.requestAnimationFrame(()=>{this.rebuildLayout()}),window.requestAnimationFrame(()=>this._buildInProgress=!1);break}}),this._mutationObserver.observe(this._element,{childList:!0,subtree:!1})}disconnectedCallback(){this._mutationObserver!=null&&this._mutationObserver.disconnect()}initSplit(){this._items.length&&(this._element.style[this.direction==="row"?"grid-template-rows":"grid-template-columns"]=this.getGridTemplate(),this.removeGuttersMargin(),U(this.getGutters()))}handlePanelDragEnd(){const e=this._items.map(t=>({id:t.id,height:t.clientHeight,width:t.clientWidth}));this.resizeEnd.emit({panelId:this._element.id,items:e})}getGutters(){const e={columnGutters:[],rowGutters:[],onDragEnd:()=>this.handlePanelDragEnd()};if(!this._items.length)return e;const t=this.direction==="row"?"rowGutters":"columnGutters";return this._items.forEach((r,i)=>{if(i===this._items.length-1)return;let s=r.dataset.trackNumber;i===this._items.length-1&&(s=this._items.length.toString()),e[t].push({track:Number(s),element:this._element.querySelector(`ez-split-panel[data-panel-id="${this._panelID}"] > [data-item-track="${r.dataset.trackNumber}"]`)})}),e}addItemGutter(e){const t=document.createElement("div");t.classList.add("ez-split-gutter"),t.classList.add(this.direction),this.direction==="row"?t.classList.add("ez-split-gutter__row"):t.classList.add("ez-split-gutter__column"),t.dataset.itemTrack=`${e.dataset.trackNumber}`,t.dataset.trackNumber=(Number(e.dataset.trackNumber)+1).toString(),e.parentNode.insertBefore(t,e.nextSibling)}getElementStyle(){return{display:"grid",height:"100%",width:"100%",position:this.anchorToExpand?"relative":"unset"}}calcFreeSpacePercentage(){const e=this._items.reduce((i,s)=>{var o;return i+(!((o=s.size)===null||o===void 0)&&o.includes("%")?Number(s.size.replace("%","")):0)},0),t=this._items.filter(i=>i.size===void 0).length;return!t||!e?null:(100-e)/t}getGridTemplate(){let e="";const t=this.calcFreeSpacePercentage();return this._items.forEach((r,i)=>{let s=r.size||"1fr";if(!r.size&&t&&(s=`${t}%`),i===this._items.length-1){e+=` ${s}`;return}if(i===0){e+=`${s} 5px`;return}e+=` ${s} 5px`}),e}removeGuttersMargin(){if(!(this._items.length<=1)){if(this.direction=="column"){this.removeGuttersMarginColumn();return}if(this.direction=="row"){this.removeGuttersMarginRow();return}}}removeGuttersMarginColumn(){this._items.forEach((e,t)=>{if(t==0){e.style.marginRight="0";return}if(t===this._items.length-1){e.style.marginLeft="0";return}e.style.marginRight="0",e.style.marginLeft="0"})}removeGuttersMarginRow(){this._items.length<=1||this._items.forEach((e,t)=>{if(t==0){e.style.marginBottom="0";return}if(t===this._items.length-1){e.style.marginTop="0";return}e.style.marginBottom="0",e.style.marginTop="0"})}render(){return D(x,{class:`${this.structural?"structural__panel":"content__panel"}`,style:this.getElementStyle()})}get _element(){return C(this)}};F.style=V;export{F as ez_split_panel};
//# sourceMappingURL=ez-split-panel.entry-CP82y8cq.js.map

{"version":3,"file":"ez-time-input.entry-B2iJOmnI.js","sources":["../../node_modules/@sankhyalabs/ezui/dist/esm/ez-time-input.entry.js"],"sourcesContent":["import { r as registerInstance, c as createEvent, h, H as Host, g as getElement } from './index-baa5e267.js';\nimport { TimeFormatter, MaskFormatter, NumberUtils, ElementIDUtils } from '@sankhyalabs/core';\nimport { C as CSSVarsUtils } from './CSSVarsUtils-acba92d7.js';\n\nconst ezTimeInputCss = \":host{display:flex;flex-wrap:wrap;position:relative;width:100%}.time__input{height:100%}\";\n\nconst EzTimeInput = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.ezChange = createEvent(this, \"ezChange\", 7);\n    this.ezStartChange = createEvent(this, \"ezStartChange\", 7);\n    this.ezCancelWaitingChange = createEvent(this, \"ezCancelWaitingChange\", 7);\n    this.label = undefined;\n    this.value = undefined;\n    this.enabled = true;\n    this.errorMessage = undefined;\n    this.showSeconds = false;\n    this.mode = \"regular\";\n    this.canShowError = true;\n    this.autoFocus = false;\n    this.alternativePlaceholder = undefined;\n  }\n  observeErrorMessage() {\n    var _a;\n    if (this._textInput) {\n      this._textInput.errorMessage = this.errorMessage;\n      if (!((_a = this.errorMessage) === null || _a === void 0 ? void 0 : _a.trim())) {\n        this.prepareValue(this._viewValue);\n        if ((this._textInput.value || '') !== this._viewValue) {\n          this._textInput.value = this._viewValue;\n        }\n      }\n    }\n  }\n  observeShowSeconds() {\n    if (this.showSeconds) {\n      this.prepareMask(\"##:##:##\");\n    }\n    else {\n      this.prepareMask(\"##:##\");\n    }\n  }\n  observeValue(newValue, oldValue) {\n    if (this._textInput && newValue != oldValue) {\n      let newValueValidated = this.validateValue(newValue);\n      const oldValueValidated = this.validateValue(oldValue);\n      if (newValueValidated != oldValueValidated) {\n        this._viewValue = newValueValidated == undefined ? \"\" : newValueValidated.toString();\n        this.prepareValue(this._viewValue);\n        if (this._viewValue && !TimeFormatter.validateTime(this._viewValue, this.showSeconds)) {\n          this.setError(\"Favor inserir um horário válido.\");\n          newValueValidated = undefined;\n        }\n        else {\n          this.setError(\"\");\n        }\n        const valueEmitted = newValueValidated === null ? undefined : newValueValidated;\n        this.ezChange.emit(valueEmitted);\n      }\n    }\n  }\n  //---------------------------------------------\n  // Private methods\n  //---------------------------------------------\n  prepareMask(mask) {\n    if (this._maskFormatter == undefined) {\n      this._maskFormatter = new MaskFormatter(mask);\n    }\n    else {\n      this._maskFormatter.mask = mask;\n    }\n  }\n  validateValue(value) {\n    return isNaN(value) || value === undefined ? null : value;\n  }\n  setError(msg) {\n    this.errorMessage = msg;\n    if (this._textInput && (msg === null || msg === void 0 ? void 0 : msg.trim())) {\n      this.ezCancelWaitingChange.emit();\n    }\n  }\n  //---------------------------------------------\n  // Public methods\n  //---------------------------------------------\n  getViewValue() {\n    return this._viewValue;\n  }\n  prepareValue(value) {\n    try {\n      this._viewValue = TimeFormatter.prepareValue(value, this.showSeconds);\n      if (this._textInput && this._textInput.value !== this._viewValue) {\n        this._textInput.value = this._viewValue;\n      }\n    }\n    catch (e) {\n      this.setError(e.message);\n    }\n  }\n  /**\n   * Aplica o foco no campo.\n   */\n  async setFocus({ selectText }) {\n    this._textInput.setFocus({ selectText });\n  }\n  /**\n   * Remove o foco do campo.\n   */\n  async setBlur() {\n    this._textInput.setBlur();\n  }\n  /**\n   * Retorna se o conteúdo é inválido.\n   */\n  async isInvalid() {\n    return typeof this.errorMessage === \"string\" && this.errorMessage.trim() !== \"\";\n  }\n  //---------------------------------------------\n  // Event handlers\n  //---------------------------------------------\n  handleBlur() {\n    if (this._textInput) {\n      this._viewValue = this._textInput.value;\n      this.prepareValue(this._viewValue);\n      const value = NumberUtils.stringToNumber(this._viewValue.replace(/\\D/g, \"\"));\n      this.value = ['string', 'number'].includes(typeof value) ? value : null;\n    }\n  }\n  handleInput() {\n    const textInputValue = this._textInput.value;\n    if (!['string', 'number'].includes(typeof textInputValue))\n      return;\n    const parsedNumber = NumberUtils.stringToNumber(textInputValue.replace(/\\D/g, \"\"));\n    if (parsedNumber !== this.value) {\n      this.ezStartChange.emit({ waitmessage: \"\", blocking: false });\n    }\n  }\n  //---------------------------------------------\n  // Lifecycle web component\n  //---------------------------------------------\n  componentDidLoad() {\n    CSSVarsUtils.applyVarsTextInput(this._elem, this._textInput);\n    if (this.autoFocus) {\n      requestAnimationFrame(() => {\n        this.setFocus({ selectText: true });\n      });\n    }\n  }\n  componentWillLoad() {\n    this.observeShowSeconds();\n    if (this.value) {\n      this.prepareValue(this.value.toString());\n    }\n    else if (this._viewValue) {\n      this.prepareValue(this._viewValue);\n    }\n  }\n  render() {\n    ElementIDUtils.addIDInfoIfNotExists(this._elem, 'input');\n    return (h(Host, null, h(\"ez-text-input\", { class: \"time__input\", \"data-element-id\": ElementIDUtils.getInternalIDInfo(\"textInput\"), ref: (el) => this._textInput = el, \"data-slave-mode\": \"true\", value: this._viewValue, enabled: this.enabled, label: this.label, restrict: \"0123456789:\", onBlur: () => this.handleBlur(), onInput: () => this.handleInput(), errorMessage: this.errorMessage, mode: this.mode, canShowError: this.canShowError, alternativePlaceholder: this.alternativePlaceholder }, h(\"ez-icon\", { slot: \"leftIcon\", iconName: \"timer-outline\" }))));\n  }\n  static get assetsDirs() { return [\"../assets\"]; }\n  get _elem() { return getElement(this); }\n  static get watchers() { return {\n    \"errorMessage\": [\"observeErrorMessage\"],\n    \"showSeconds\": [\"observeShowSeconds\"],\n    \"value\": [\"observeValue\"]\n  }; }\n};\nEzTimeInput.style = ezTimeInputCss;\n\nexport { EzTimeInput as ez_time_input };\n"],"names":["ezTimeInputCss","EzTimeInput","hostRef","registerInstance","createEvent","_a","newValue","oldValue","newValueValidated","oldValueValidated","TimeFormatter","valueEmitted","mask","MaskFormatter","value","msg","e","selectText","NumberUtils","textInputValue","CSSVarsUtils","ElementIDUtils","h","Host","el","getElement"],"mappings":"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","x_google_ignoreList":[0]}
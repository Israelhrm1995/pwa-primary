import{J as l,$ as h,S as p}from"./index-CxFxc26b.js";const c=["meta","shift","alt","ctrl"];class E{constructor(e){this._shadowRoots=[],this._mappedElements={},this._options=Object.assign({type:"keydown",propagate:!1,element:document.body,debounceTime:0,enableShadowDom:!1},e),this._options.enableShadowDom&&(this._shadowRoots=this.findAllNestedShadowRoots(this._options.element))}findAllNestedShadowRoots(e,t=[]){if(!e)return t;const o=e==null?void 0:e.shadowRoot;return o&&(t.push(o),o.querySelectorAll("*").forEach(s=>{this.findAllNestedShadowRoots(s,t)})),e.childNodes.forEach(s=>{this.findAllNestedShadowRoots(s,t)}),t}addEventListenerToNestedShadowRoots(e,t){this._shadowRoots.forEach(o=>{o.addEventListener(e,t)})}removeEventListenerToNestedShadowRoots(e,t){this._shadowRoots.forEach(o=>{o.removeEventListener(e,t)})}bind(e,t,o){var s;if(!((s=this._mappedElements)===null||s===void 0)&&s[e])throw new Error("Event already exists.");const i=Object.assign(Object.assign({},this._options),o),d=l.debounceLeading(this.handleListenerEvent,i.debounceTime,this).bind(this,e,t,i.propagate);return this._mappedElements=Object.assign(Object.assign({},this._mappedElements),{[e]:{callback:d,options:i}}),i.element.addEventListener(i.type,d),i.enableShadowDom&&this.addEventListenerToNestedShadowRoots(i.type,d),this}unbindAllShortcutKeys(e){const t=[...Object.keys(e||this._mappedElements)];t==null||t.forEach(o=>this.unbind(o))}unbind(e){var t;const o=(t=this._mappedElements)===null||t===void 0?void 0:t[e];if(!o)throw new Error("KeyMap not exists.");delete this._mappedElements[e];const{callback:s,options:{element:i,type:d}}=o;return i.removeEventListener(d,s),o.options.enableShadowDom&&this.removeEventListenerToNestedShadowRoots(d,s),this}get mappedKeys(){return Object.entries(this._mappedElements).map(([e,t])=>({[e]:t.options.description||e}))}handleListenerEvent(e,t,o,s){const{isKeyApplied:i,modifiedList:d}=this.keyAppliedWithModifiers(e,s.keyCode);i&&this.checkModifiersIsApplied(s,d)&&(this.verifyAndStopPropagation(s,o),(t||(()=>{}))())}keyAppliedWithModifiers(e,t){const o=e.split("+");let s=!1;const i=[];for(let d of o){if(d=d.trim(),c.includes(d.toLowerCase())){i.push(d);continue}h.reduce((n,{key:a,keyCode:r})=>((a==d||a==p.getOppositeCase(d))&&n.push(r),n),[]).includes(t)&&(s=!0)}return{isKeyApplied:s,modifiedList:i}}checkModifiersIsApplied(e,t){const o={shift:e.shiftKey,ctrl:e.ctrlKey,alt:e.altKey,meta:e.metaKey};if(t.length===0)return!(o.shift||o.ctrl||o.alt||o.meta);let s=!0;for(const i of t)if(!o[i]){s=!1;break}return s}verifyAndStopPropagation(e,t){var o,s;t||((o=e==null?void 0:e.preventDefault)===null||o===void 0||o.call(e),(s=e==null?void 0:e.stopPropagation)===null||s===void 0||s.call(e))}}export{E as K};
//# sourceMappingURL=index-dPP-F_x9.js.map

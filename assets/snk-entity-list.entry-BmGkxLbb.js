import{r as g,c as f,h as d,H as p}from"./index-CHxCopeG.js";import{O as c}from"./dataUnitInMemoryLoader-CwDmnNwL.js";import{A as _}from"./ApplicationContext-B_qAnYBt.js";const m=".sc-snk-entity-list-h{--snk-entity-list--label--font-size:var(--text--medium, 14px);--snk-entity-list--label--font-family:var(--font-pattern, Arial);--snk-entity-list--label--color:var(--title--primary, #000);--snk-entity-list--label--disabled--color:var(--text--disable, #AFB6C0)}.label.sc-snk-entity-list{flex-shrink:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:var(--snk-entity-list--label--color);font-size:var(--snk-entity-list--label--font-size);font-family:var(--snk-entity-list--label--font-family);cursor:default;padding-left:var(--space--small);padding-bottom:var(--space--extra-small)}.snk-entity-list--overflow.sc-snk-entity-list{overflow:auto}.snk-entity-list--overflow.sc-snk-entity-list::-webkit-scrollbar{width:var(--space--small);min-width:var(--space--small);max-width:var(--space--small)}",y=class{constructor(i){g(this,i),this.valueChanged=f(this,"valueChanged",7),this._ezListSource=[],this.config=void 0,this.rightListSlotBuilder=void 0,this.maxHeightList="",this.value=void 0}async reloadList(){this.loadListSource()}observeConfig(){var i,t;(t=(i=this._searchElement)===null||i===void 0?void 0:i.clearValue)===null||t===void 0||t.call(i)}ezListChangeListener(i){var t,e;const o=c.copy(this.config);(t=this.getListConfigValue(o))===null||t===void 0||t.forEach(l=>{var s,n;l&&l.id===((s=i.detail)===null||s===void 0?void 0:s.id)&&(l.check=(n=i.detail)===null||n===void 0?void 0:n.check)}),this.config=c.copy(o),this.valueChanged.emit((e=this.config)===null||e===void 0?void 0:e.value)}loadListSource(){var i;this._ezListSource=[],(i=this.getListConfigValue(this.config))===null||i===void 0||i.forEach(t=>{t&&this._ezListSource.push({label:`${t.id} - ${t.label}`,check:t.check,id:t.id})})}componentDidLoad(){var i,t,e,o,l;let s=this.getListConfigValue(this.config),n=[];Array.isArray(s)?n=s:n.push((t=(i=this.config)===null||i===void 0?void 0:i.value)===null||t===void 0?void 0:t.members),this.config.value=n,this._entityName=(l=(o=(e=this.config)===null||e===void 0?void 0:e.props)===null||o===void 0?void 0:o.searchContext)===null||l===void 0?void 0:l.entity,this._application=_.getContextValue("__SNK__APPLICATION__"),this.loadListSource()}optionLoader(i){var t,e,o,l,s,n;const{mode:a,argument:r}=i;if(this._application===void 0)return;const h=(o=(e=(t=this.config)===null||t===void 0?void 0:t.props)===null||e===void 0?void 0:e.searchContext)!==null&&o!==void 0?o:{},v=(s=(l=this.config)===null||l===void 0?void 0:l.props)===null||s===void 0?void 0:s.criteria,u=Object.assign(Object.assign({criteria:v},h),{entityDescription:(n=this.config)===null||n===void 0?void 0:n.label,entity:this._entityName});return this._application.executePreparedSearch(a,r,u)}onEzSearchChange(i){var t,e,o,l;const s=c.isEmptySafetyCheck(i.detail),n=(t=this.getListConfigValue(this.config))===null||t===void 0?void 0:t.find(a=>{var r;return(a==null?void 0:a.id)===((r=i.detail)===null||r===void 0?void 0:r.value)});s||n||(this.config=Object.assign(Object.assign({},this.config),{value:[...(o=(e=this.config)===null||e===void 0?void 0:e.value)!==null&&o!==void 0?o:[],{id:i.detail.value,check:!0,label:i.detail.label}]}),this.loadListSource(),this.value=this.config.value,this.valueChanged.emit((l=this.config)===null||l===void 0?void 0:l.value))}getMessage(i,t){var e;return(e=this._application)===null||e===void 0?void 0:e.messagesBuilder.getMessage(i,t)}getListConfigValue(i){var t,e,o,l;return(l=(e=(t=i.value)===null||t===void 0?void 0:t.elements)!==null&&e!==void 0?e:(o=i==null?void 0:i.value)===null||o===void 0?void 0:o.members)!==null&&l!==void 0?l:i==null?void 0:i.value}render(){var i,t,e;const l=((i=this.config.props)===null||i===void 0?void 0:i.useSearchPlus)==!0?"ez-search-plus":"ez-search";return d(p,null,d(l,{ref:s=>this._searchElement=s,optionLoader:s=>this.optionLoader(s),label:(t=this.config)===null||t===void 0?void 0:t.label,onEzChange:s=>this.onEzSearchChange(s),suppressEmptyOption:!0,stopPropagateEnterKeyEvent:!0}),((e=this._ezListSource)===null||e===void 0?void 0:e.length)>0&&d("label",{class:"label"},this.getMessage("snkEntityList.selected")),d("div",{style:this.maxHeightList?{"max-height":this.maxHeightList}:{},class:{"snk-entity-list--overflow":!!this.maxHeightList}},d("ez-list",{ref:s=>this._ezList=s,id:"snkEntityList",listMode:"check",dataSource:this._ezListSource,hoverFeedback:!0,itemSlotBuilder:this.rightListSlotBuilder,onEzCheckChange:s=>this.ezListChangeListener(s)})))}static get watchers(){return{config:["observeConfig"]}}};y.style=m;export{y as snk_entity_list};
//# sourceMappingURL=snk-entity-list.entry-BmGkxLbb.js.map

{"version":3,"file":"snk-entity-list.entry-DYqVeC7x.js","sources":["../../node_modules/@sankhyalabs/sankhyablocks/dist/esm/snk-entity-list.entry.js"],"sourcesContent":["import { r as registerInstance, c as createEvent, h, H as Host } from './index-479e1293.js';\nimport { ObjectUtils, ApplicationContext } from '@sankhyalabs/core';\n\nconst snkEntityListCss = \".sc-snk-entity-list-h{--snk-entity-list--label--font-size:var(--text--medium, 14px);--snk-entity-list--label--font-family:var(--font-pattern, Arial);--snk-entity-list--label--color:var(--title--primary, #000);--snk-entity-list--label--disabled--color:var(--text--disable, #AFB6C0)}.label.sc-snk-entity-list{flex-shrink:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:var(--snk-entity-list--label--color);font-size:var(--snk-entity-list--label--font-size);font-family:var(--snk-entity-list--label--font-family);cursor:default;padding-left:var(--space--small);padding-bottom:var(--space--extra-small)}.snk-entity-list--overflow.sc-snk-entity-list{overflow:auto}.snk-entity-list--overflow.sc-snk-entity-list::-webkit-scrollbar{width:var(--space--small);min-width:var(--space--small);max-width:var(--space--small)}\";\n\nconst SnkEntityList = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.valueChanged = createEvent(this, \"valueChanged\", 7);\n    this._ezListSource = [];\n    this.config = undefined;\n    this.rightListSlotBuilder = undefined;\n    this.maxHeightList = \"\";\n    this.value = undefined;\n  }\n  async reloadList() {\n    this.loadListSource();\n  }\n  observeConfig() {\n    var _a, _b;\n    (_b = (_a = this._searchElement) === null || _a === void 0 ? void 0 : _a['clearValue']) === null || _b === void 0 ? void 0 : _b.call(_a);\n  }\n  ezListChangeListener(evt) {\n    var _a, _b;\n    const configCopy = ObjectUtils.copy(this.config);\n    (_a = (this.getListConfigValue(configCopy))) === null || _a === void 0 ? void 0 : _a.forEach(value => {\n      var _a, _b;\n      if (value && value.id === ((_a = evt.detail) === null || _a === void 0 ? void 0 : _a.id)) {\n        value.check = (_b = evt.detail) === null || _b === void 0 ? void 0 : _b.check;\n      }\n    });\n    this.config = ObjectUtils.copy(configCopy);\n    this.valueChanged.emit((_b = this.config) === null || _b === void 0 ? void 0 : _b.value);\n  }\n  loadListSource() {\n    var _a;\n    this._ezListSource = [];\n    (_a = (this.getListConfigValue(this.config))) === null || _a === void 0 ? void 0 : _a.forEach(value => {\n      if (value) {\n        this._ezListSource.push({\n          label: `${value.id} - ${value.label}`,\n          check: value.check,\n          id: value.id\n        });\n      }\n    });\n  }\n  componentDidLoad() {\n    var _a, _b, _c, _d, _e;\n    let configValue = this.getListConfigValue(this.config);\n    let configValueArray = [];\n    if (Array.isArray(configValue)) {\n      configValueArray = configValue;\n    }\n    else {\n      configValueArray.push((_b = (_a = this.config) === null || _a === void 0 ? void 0 : _a.value) === null || _b === void 0 ? void 0 : _b.members);\n    }\n    this.config.value = configValueArray;\n    this._entityName = (_e = (_d = (_c = this.config) === null || _c === void 0 ? void 0 : _c.props) === null || _d === void 0 ? void 0 : _d.searchContext) === null || _e === void 0 ? void 0 : _e.entity;\n    this._application = ApplicationContext.getContextValue(\"__SNK__APPLICATION__\");\n    this.loadListSource();\n  }\n  optionLoader(searchArgument) {\n    var _a, _b, _c, _d, _e, _f;\n    const { mode, argument } = searchArgument;\n    if (this._application === undefined) {\n      return;\n    }\n    const searchContext = (_c = (_b = (_a = this.config) === null || _a === void 0 ? void 0 : _a.props) === null || _b === void 0 ? void 0 : _b.searchContext) !== null && _c !== void 0 ? _c : {};\n    const criteria = (_e = (_d = this.config) === null || _d === void 0 ? void 0 : _d.props) === null || _e === void 0 ? void 0 : _e.criteria;\n    const options = Object.assign(Object.assign({ criteria }, searchContext), { entityDescription: (_f = this.config) === null || _f === void 0 ? void 0 : _f.label, entity: this._entityName });\n    return this._application.executePreparedSearch(mode, argument, options);\n  }\n  onEzSearchChange(evt) {\n    var _a, _b, _c, _d;\n    const newValueIsEmpty = ObjectUtils.isEmptySafetyCheck(evt.detail);\n    const hasConfingOnList = (_a = this.getListConfigValue(this.config)) === null || _a === void 0 ? void 0 : _a.find((i) => { var _a; return (i === null || i === void 0 ? void 0 : i.id) === ((_a = evt.detail) === null || _a === void 0 ? void 0 : _a.value); });\n    if (newValueIsEmpty || hasConfingOnList) {\n      return;\n    }\n    this.config = Object.assign(Object.assign({}, this.config), { value: [\n        ...((_c = (_b = this.config) === null || _b === void 0 ? void 0 : _b.value) !== null && _c !== void 0 ? _c : []),\n        {\n          id: evt.detail.value,\n          check: true,\n          label: evt.detail.label\n        }\n      ] });\n    this.loadListSource();\n    this.value = this.config.value;\n    this.valueChanged.emit((_d = this.config) === null || _d === void 0 ? void 0 : _d.value);\n  }\n  getMessage(key, params) {\n    var _a;\n    return (_a = this._application) === null || _a === void 0 ? void 0 : _a.messagesBuilder.getMessage(key, params);\n  }\n  getListConfigValue(config) {\n    var _a, _b, _c, _d;\n    return (_d = (_b = (_a = config.value) === null || _a === void 0 ? void 0 : _a.elements) !== null && _b !== void 0 ? _b : (_c = config === null || config === void 0 ? void 0 : config.value) === null || _c === void 0 ? void 0 : _c.members) !== null && _d !== void 0 ? _d : config === null || config === void 0 ? void 0 : config.value;\n  }\n  render() {\n    var _a, _b, _c;\n    const isSearchPlus = ((_a = this.config.props) === null || _a === void 0 ? void 0 : _a[\"useSearchPlus\"]) == true;\n    const TagName = isSearchPlus ? \"ez-search-plus\" : \"ez-search\";\n    return (h(Host, null, h(TagName, { ref: elem => this._searchElement = elem, optionLoader: argument => this.optionLoader(argument), label: (_b = this.config) === null || _b === void 0 ? void 0 : _b.label, onEzChange: evt => this.onEzSearchChange(evt), suppressEmptyOption: true, stopPropagateEnterKeyEvent: true }), ((_c = this._ezListSource) === null || _c === void 0 ? void 0 : _c.length) > 0 && (h(\"label\", { class: \"label\" }, this.getMessage(\"snkEntityList.selected\"))), h(\"div\", { style: this.maxHeightList ? { 'max-height': this.maxHeightList } : {}, class: { \"snk-entity-list--overflow\": !!this.maxHeightList } }, h(\"ez-list\", { ref: (el) => this._ezList = el, id: \"snkEntityList\", listMode: \"check\", dataSource: this._ezListSource, hoverFeedback: true, itemSlotBuilder: this.rightListSlotBuilder, onEzCheckChange: evt => this.ezListChangeListener(evt) }))));\n  }\n  static get watchers() { return {\n    \"config\": [\"observeConfig\"]\n  }; }\n};\nSnkEntityList.style = snkEntityListCss;\n\nexport { SnkEntityList as snk_entity_list };\n"],"names":["snkEntityListCss","SnkEntityList","hostRef","registerInstance","createEvent","_a","_b","evt","configCopy","ObjectUtils","value","_c","_d","_e","configValue","configValueArray","ApplicationContext","searchArgument","_f","mode","argument","searchContext","criteria","options","newValueIsEmpty","hasConfingOnList","i","key","params","config","TagName","h","Host","elem","el"],"mappings":"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","x_google_ignoreList":[0]}
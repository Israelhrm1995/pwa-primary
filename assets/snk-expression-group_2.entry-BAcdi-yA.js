import{r as F,c as g,h as r,f as _,H as I,g as A}from"./index-DA6RLjux.js";import{a as c,F as b}from"./index-8acbae97-DxLtPl40.js";import{C as E,A as T}from"./FormLayout-pPi2ZB-q.js";import{O as D,S as x,U as l,E as f,B as C}from"./dataUnitInMemoryLoader-BjgoPaoq.js";import{A as L}from"./ApplicationContext-B_qAnYBt.js";import{S as z}from"./index-620ac460-DzCD8Y6b.js";import{R as O}from"./constants-CKEKe-xZ.js";import{h as a}from"./index-BdigElPL.js";import{s as v}from"./index-b72af127-COgwDPId.js";const R=e=>S(e.name,e.label,e.readOnly,e.contextName,!0),w=e=>S(e.name,e.label,e.readOnly,e.contextName,!1);function S(e,i,s,t,n){return a("div",{class:"ez-col ez-col--sd-12 ez-align--middle ez-padding-bottom--large"},a("ez-check",{enabled:!s,label:i,mode:n?E.SWITCH:E.REGULAR,"data-field-name":e,"data-context-name":t,key:e}))}const G=({name:e,label:i,readOnly:s,required:t,props:n,contextName:o,canShowError:d})=>{const p=n==null?void 0:n.options;let u;if(typeof p=="string"){const m=JSON.parse(p);u=Object.keys(m).map(k=>({value:k,label:m[k]}))}else u=p;return a("div",{class:"ez-col ez-col--sd-12"},a("ez-combo-box",{class:"ez-input__no-margin",enabled:!s,suppressEmptyOption:t,label:i,"data-field-name":e,"data-context-name":o,key:e,options:u,canShowError:d}))},M=({name:e,label:i,readOnly:s,canShowError:t})=>a("div",{class:"ez-col ez-col--sd-12"},a("ez-date-input",{class:"ez-input__no-margin",enabled:!s,label:i,"data-field-name":e,key:e,canShowError:t})),P=({name:e,label:i,readOnly:s,canShowError:t,props:n})=>{var o;return a("div",{class:"ez-col ez-col--sd-12"},a("ez-time-input",{class:"ez-input__no-margin",enabled:!s,label:i,"data-field-name":e,key:e,canShowError:t,"show-seconds":(o=n==null?void 0:n.showSeconds)!==null&&o!==void 0?o:!1}))},V=({name:e,label:i,readOnly:s,canShowError:t})=>a("div",{class:"ez-col ez-col--sd-12"},a("ez-time-input",{class:"ez-input__no-margin",enabled:!s,label:i,"data-field-name":e,key:e,canShowError:t,showSeconds:!0})),U=({name:e,label:i,readOnly:s,contextName:t,canShowError:n})=>a("div",{class:"ez-col ez-col--sd-12"},a("ez-date-time-input",{class:"ez-input__no-margin",enabled:!s,label:i,"data-field-name":e,"data-context-name":t,key:e,canShowError:n})),B=({name:e,label:i,readOnly:s,contextName:t,props:n})=>{const o=D.removeEmptyValues({subTitle:n.subTitle,requestHeaders:Object.assign(Object.assign({},n.STORAGESTRATEGY&&{STORAGESTRATEGY:n.STORAGESTRATEGY}),n.INTERNAL_FILENAME&&{INTERNAL_FILENAME:n.INTERNAL_FILENAME})});return a("div",{class:"ez-col ez-col--sd-12"},a("ez-upload",Object.assign({enabled:!s,label:i,"data-field-name":e,"data-context-name":t,key:e},o)))},H=({name:e,label:i,readOnly:s,props:t,contextName:n,canShowError:o})=>{var d,p;const u=Number((d=t==null?void 0:t.precision)!==null&&d!==void 0?d:2),m=Number((p=t==null?void 0:t.prettyPrecision)!==null&&p!==void 0?p:u);return N(e,i,s,u,m,n,o)},$=({name:e,label:i,readOnly:s,contextName:t,canShowError:n})=>N(e,i,s,0,0,t,n);function N(e,i,s,t,n,o,d){return a("div",{class:"ez-col ez-col--sd-12"},a("ez-number-input",{class:"ez-input__no-margin",enabled:!s,label:i,precision:t,prettyPrecision:n,"data-field-name":e,"data-context-name":o,key:e,canShowError:d}))}const j=({name:e,label:i,readOnly:s,contextName:t,rows:n,canShowError:o})=>a("div",{class:"ez-col ez-col--sd-12",key:e},a("ez-text-area",{enabled:!s,label:i,"data-field-name":e,"data-context-name":t,rows:n,canShowError:o})),W=({name:e,label:i,readOnly:s,contextName:t,canShowError:n,props:o})=>a("div",{class:"ez-col ez-col--sd-12"},a("ez-text-input",{class:"ez-input__no-margin",label:i,"data-field-name":e,"data-context-name":t,key:e,enabled:!s,canShowError:n,mask:o==null?void 0:o.mask,"clean-value-mask":o==null?void 0:o.cleanValueMask})),X=({name:e,label:i,readOnly:s,contextName:t,canShowError:n,optionLoader:o,props:d})=>{const p=!x.isEmpty(d==null?void 0:d.DESCRIPTIONFIELD);return a("div",{class:"ez-col ez-col--sd-12"},a("ez-search-plus",{class:"ez-input__no-margin",enabled:!s,label:i,"data-field-name":e,"data-context-name":t,key:e,canShowError:n,optionLoader:o,hideDescriptionInput:!p}))},K=({name:e,label:i,readOnly:s,required:t,contextName:n,canShowError:o,optionLoader:d,props:p})=>{var u;return a("div",{class:"ez-col ez-col--sd-12"},a("ez-search",{class:"ez-input__no-margin",enabled:!s,suppressEmptyOption:t,label:i,"data-field-name":e,"data-context-name":n,key:e,canShowError:o,optionLoader:d,ignoreLimitCharsToSearch:(u=p==null?void 0:p.ignoreLimitCharsToSearch)!==null&&u!==void 0?u:!1}))},Y=({name:e,label:i,readOnly:s,contextName:t,rows:n,canShowError:o})=>a("div",{class:"ez-col ez-col--sd-12"},a("ez-rich-text",{key:e,enabled:!s,label:i,"data-field-name":e,"data-context-name":t,rows:n,canShowError:o})),h=new Map;h.set(l.CHECKBOX,w);h.set(l.SWITCH,R);h.set(l.OPTIONSELECTOR,G);h.set(l.DATE,M);h.set(l.TIME,P);h.set(l.ELAPSEDTIME,V);h.set(l.DATETIME,U);h.set(l.FILE,B);h.set(l.DECIMALNUMBER,H);h.set(l.INTEGERNUMBER,$);h.set(l.SEARCH,K);h.set(l.SEARCHPLUS,X);h.set(l.LONGTEXT,j);h.set(l.HTML,Y);const Q=e=>{const i=h.get(e.userInterface)||W,s=e.required?`${e.label}${O}`:e.label,t=i(Object.assign(Object.assign({},e),{label:s}));return t.$attrs$["data-form-item"]=e.name,t},J='.sc-snk-expression-group-h{display:block;--snk-expression-group--container-condition--width:184px;--snk-expression-group--container-condition--height:38px;--snk-expression-group--container-condition--border-radius:var(--border--radius-medium, 12px);--snk-expression-group--container-option--width:85px;--snk-expression-group__container-condition--background-and:#66B6A0;--snk-expression-group__container-condition--background-or:#EBC65E;--snk-expression-group__container-expression--padding-left:26px;--snk-expression-group__background-color-dashed:var(--background--body, #fafcff);--ez-text-input__margin-bottom:0px}.snk-expression-group__container-condition.sc-snk-expression-group{width:var(--snk-expression-group--container-condition--width);height:var(--snk-expression-group--container-condition--height);border-radius:var(--snk-expression-group--container-condition--border-radius);z-index:var(--more-visible--2x, 3);padding:var(--space--nano, 2px)}.snk-expression-group__container-option.sc-snk-expression-group{width:var(--snk-expression-group--container-option--width)}.snk-expression-group__container-condition[data-condition="AND"].sc-snk-expression-group{background-color:var(--snk-expression-group__container-condition--background-and)}.snk-expression-group__container-condition[data-condition="OR"].sc-snk-expression-group{background-color:var(--snk-expression-group__container-condition--background-or)}.snk-expression-group__container-expression.sc-snk-expression-group{padding-left:var(--snk-expression-group__container-expression--padding-left)}.dashes.sc-snk-expression-group{z-index:var(--visible, 1);background:var(--snk-expression-group__background-color-dashed);border-left:2px dashed var(--text-secondary, #A2ABB9);position:absolute;width:15px;height:58px;margin-left:-15px;margin-top:-36.5px}.horizontal-dashes.sc-snk-expression-group{z-index:var(--more-visible, 2);border-bottom:2px dashed var(--text-secondary, #A2ABB9);position:absolute;width:15px;height:54px;margin-left:-15px;margin-top:-33.5px}.hidden.sc-snk-expression-group{display:none}',q=class{constructor(e){F(this,e),this.ezFilterGroupChange=g(this,"ezFilterGroupChange",7),this.ezFilterGroupRemove=g(this,"ezFilterGroupRemove",7),this.ezExpressionGroupLayoutChanged=g(this,"ezExpressionLayoutChanged",7),this.FIRST_LEVEL="0",this.LIMIT_GROUP_LEVEL=4,this.application=L.getContextValue("__SNK__APPLICATION__"),this._conditionOperator=c.AND,this._group=void 0,this._selfTop=0,this.canAddExpression=!0,this._showDashes=!0,this.parentTop=0,this.group=void 0,this.messagesBuilder=void 0,this.filterId=void 0,this.entityURI=void 0,this.isDefaultFilter=!1}todoCompletedHandler(e){this.updateDashes()}async getExpressionGroup(){return this._group}watchGroup(e){this._group=e,this._conditionOperator=this.getOperand()}componentWillLoad(){this._group=this.group,this._conditionOperator=this.getOperand(),this.getDataGroupLevel()||this._element.setAttribute("data-group-level",this.FIRST_LEVEL),this.canAddExpression=this.group.items.every(this.isFilledItem)}componentDidRender(){this.setSelfTop()}changeHandler(){this.ezExpressionGroupLayoutChanged.emit()}setSelfTop(){this._selfTop=this._element.getBoundingClientRect().top}getDashedHeight(){return this._selfTop-this.parentTop}getOperand(){return this._group.operand?this._group.operand:c.AND}getMessage(e,i){return this.application.messagesBuilder.getMessage(e,i)}updateDashes(){this._showDashes=!1,this.setSelfTop(),this._showDashes=!0}renderExpressionItems(){var e;return(e=this._group.items)===null||e===void 0?void 0:e.map(i=>r("snk-expression-item",{key:i.id,class:"ez-padding-top--small snk-expression-group__item",expression:i,canRemove:this._group.items.length>1,onEzFilterItemChange:()=>this.handleFilterItemChange(),onEzFilterItemRemove:s=>this.handleFilterItemRemove(s,i.id),messagesBuilder:this.messagesBuilder,entityURI:this.entityURI,isDefaultFilter:this.isDefaultFilter}))}renderGroups(){var e;const s=parseInt(this.getDataGroupLevel()||"0")+1;return(e=this._group.childrenGroups)===null||e===void 0?void 0:e.map(t=>r("snk-expression-group",{key:t.id,group:t,messagesBuilder:this.messagesBuilder,parentTop:this._selfTop,"data-group-level":s,onEzFilterGroupRemove:n=>this.handleFilterGroupRemove(n,t.id),entityURI:this.entityURI}))}handleFilterGroupRemove(e,i){this.onStopPropagation(e),this._group.childrenGroups=this._group.childrenGroups.filter(s=>s.id!==i),_(this),this.ezFilterGroupChange.emit(this._group),this.changeHandler()}handleFilterItemRemove(e,i){this.onStopPropagation(e),this._group.items=this._group.items.filter(s=>s.id!==i),_(this),this.ezFilterGroupChange.emit(this._group),this.changeHandler(),this.canAddExpression=!0}isFilledItem(e){return!e.fieldName||!e.operand?!1:e.operand==="NULL"||e.operand==="NOT_NULL"||e.paramVariable||e.userInterface==="SWITCH"?!0:!!e.value}handleFilterItemChange(){this.ezFilterGroupChange.emit(this._group),this.canAddExpression=this.group.items.every(this.isFilledItem)}handleAddExpression(){const e={id:x.generateUUID(),entityName:"",fieldName:"",description:"",label:"Valor",type:void 0,expression:void 0,operand:void 0,paramVariable:!1,value:void 0,systemConfig:null,userConfig:null};this._group.items.push(e),_(this),this.ezFilterGroupChange.emit(this.group),this.changeHandler(),this.canAddExpression=!1}handleAddGroup(){var e;const i={id:x.generateUUID(),items:[{id:x.generateUUID(),entityName:"",fieldName:"",description:"",label:"Valor",type:void 0,expression:void 0,operand:void 0,paramVariable:!1,value:void 0,systemConfig:null,userConfig:null}],childrenGroups:[],operand:c.AND};this._group.childrenGroups=(e=this._group.childrenGroups)!==null&&e!==void 0?e:[],this._group.childrenGroups.push(i),_(this),this.group.operand||(this.group.operand=c.AND),this.ezFilterGroupChange.emit(this.group),this.changeHandler()}buildGroupStyle(){return{height:`${this.getDashedHeight()}px`,marginTop:`${-this.getDashedHeight()+20}px`}}handleConditionOperatorChange(e){this._conditionOperator=e,this._group.operand=c[e],this.ezFilterGroupChange.emit(this._group)}confirmRemoveGroup(e){this.onStopPropagation(e),T.confirm(this.getMessage("snkPersonalizedFilter.confirmGroup.title"),this.getMessage("snkPersonalizedFilter.confirmGroup.description")).then(i=>{i&&this.ezFilterGroupRemove.emit(this._group)})}getTooltipMessageForOperator(){if(this.getDataGroupLevel()===this.FIRST_LEVEL&&this._group.items.length===1)return this.getMessage("snkPersonalizedFilter.operador.firstLevel");if(this._conditionOperator===c.AND)return this.getMessage("snkPersonalizedFilter.operador.and");if(this._conditionOperator===c.OR)return this.getMessage("snkPersonalizedFilter.operador.or")}getDataGroupLevel(){return this._element.getAttribute("data-group-level")}canAddGroup(){return Number(this.getDataGroupLevel()||this.FIRST_LEVEL)<this.LIMIT_GROUP_LEVEL}isFirstLevel(){return this.getDataGroupLevel()===this.FIRST_LEVEL}onStopPropagation(e){e.preventDefault(),e.stopPropagation()}getMessageAddTooltip(){return this.isFirstLevel()?this.group.items.every(i=>!i.fieldName||!i.operand?!1:i.paramVariable||!!i.value)?this.getMessage("snkPersonalizedFilter.info.labelAddNewExpression"):this.getMessage("snkPersonalizedFilter.info.labelDisabledAddExpressionButton"):this.canAddExpression?this.getMessage("snkPersonalizedFilter.info.labelAddNewExpression"):this.getMessage("snkPersonalizedFilter.info.labelDisabledAddExpressionButton")}canChangeGroupCondition(){return this._group.items.length+this._group.childrenGroups.length>1}render(){const e=this.canAddGroup();return r(I,null,r("div",{class:!this.isFirstLevel()&&this._showDashes?"dashes":"hidden",style:this.buildGroupStyle()}),r("div",{class:!this.isFirstLevel()&&this._showDashes?"horizontal-dashes":"hidden"}),r("div",{class:"ez-flex ez-flex--align-items-center"},r("div",{class:"snk-expression-group__container-condition ez-flex ez-flex-item--align-center ez-flex--align-items-center","data-condition":this._conditionOperator,title:this.getTooltipMessageForOperator()},r("label",{class:"ez-label ez-padding-right--medium ez-padding-left--medium ez-title--primary"},this.getMessage("snkPersonalizedFilter.info.condition")),r("div",null,r("ez-combo-box",Object.assign({class:"snk-expression-group__container-option",canShowError:!1,mode:"slim",suppressEmptyOption:!0,enabled:this.canChangeGroupCondition(),value:this._conditionOperator,onEzChange:i=>this.handleConditionOperatorChange(i.detail.value)},{[f.DATA_ELEMENT_ID_ATTRIBUTE_NAME]:`comboBoxConditions_level_${this.getDataGroupLevel()}`}),r("option",{value:c.AND},"E"),r("option",{value:c.OR},"OU")))),r("ez-button",{class:"ez-padding-right--medium ez-padding-left--medium",mode:"icon",iconName:"plus",size:"small",enabled:this.canAddExpression,title:this.getMessageAddTooltip(),onClick:()=>this.handleAddExpression()}),r("ez-button",{label:this.getMessage("snkPersonalizedFilter.info.addGroup"),size:"small",enabled:e,title:e?"":this.getMessage("snkPersonalizedFilter.info.labelDisabledAddGroupButton",{LIMIT_GROUP_LEVEL:this.LIMIT_GROUP_LEVEL+1}),onClick:()=>this.handleAddGroup()},r("ez-icon",{class:"ez-padding-right--small",slot:"leftIcon",iconName:"plus"})),!this.isFirstLevel()&&r("ez-button",{title:this.getMessage("snkPersonalizedFilter.info.labelDeleteExpression"),class:"ez-padding-left--medium",mode:"icon",iconName:"delete",size:"small",onClick:i=>this.confirmRemoveGroup(i)})),r("div",{class:"ez-padding-top--small snk-expression-group__container-expression"},r("div",{class:"ez-padding-top--small"},this.renderExpressionItems())),r("div",{class:"ez-padding-top--small snk-expression-group__container-expression"},r("div",{class:"ez-padding-top--small"},this.renderGroups())))}get _element(){return A(this)}static get watchers(){return{group:["watchGroup"]}}};q.style=J;const y=[{label:"Igual (=)",value:"EQUAL"},{label:"Diferente (<>)",value:"DIFFERENT"},{label:"Contendo (LIKE)",value:"LIKE"},{label:"Contido em (IN)",value:"IN"},{label:"Iniciado com (%?)",value:"START_WITH"},{label:"Terminado com (?%)",value:"FINISHED_WITH"},{label:"Vazio (NULL)",value:"NULL"},{label:"NÃ£o Vazio (NOT NULL)",value:"NOT_NULL"}],Z=y.concat([{label:"Maior (>)",value:"LARGER"},{label:"Maior ou Igual (>=)",value:"LARGER_EQUAL"},{label:"Menor (<)",value:"SMALLER"},{label:"Menor ou Igual (<=)",value:"SMALLER_EQUAL"}]),ee=y,ie=[l.SEARCH,l.SHORTTEXT,l.PASSWORD,l.MASKEDTEXT,l.LONGTEXT,l.HTML],se=".sc-snk-expression-item-h{display:flex;width:100%;--snk-expression-item--background-color:var(--background--xlight, #fff);--snk-expression-item__itens--padding:var(--space--small, 6px);--snk-expression-item__width--input-operator:220px;--snk-expression-item__width--input-value:240px;--snk-expression-item__width--input-value-variable:176px;--snk-expression-item--border-radius:var(--border--radius-medium, 12px);--snk-expression-item--border-color:var(--color--strokes, #DCE0E8);--snk-expression-item--border-style:var(--border--small, 1px solid);--snk-expression-item__background-color-dashed:var(--background--body, #fafcff)}.box.sc-snk-expression-item{width:100%;height:56px;background:var(--snk-expression-item--background-color);border:var(--snk-expression-item--border-color) var(--snk-expression-item--border-style);border-radius:var(--snk-expression-item--border-radius)}.box__container.sc-snk-expression-item{display:flex;align-items:center;justify-content:space-between;white-space:nowrap;margin:var(--space--small, 6px)}.box__container--input-filter.sc-snk-expression-item{width:100%}.box__container--input-operator.sc-snk-expression-item{display:flex;width:var(--snk-expression-item__width--input-operator);min-width:var(--snk-expression-item__width--input-operator)}.box__container--input-value.sc-snk-expression-item{display:flex;width:var(--snk-expression-item__width--input-value);min-width:var(--snk-expression-item__width--input-value)}.box__container--input-value-variable.sc-snk-expression-item{display:flex;width:var(--snk-expression-item__width--input-value-variable);min-width:var(--snk-expression-item__width--input-value-variable)}.box__container--button-delete.sc-snk-expression-item{display:flex}.box__container.sc-snk-expression-item>div.sc-snk-expression-item{padding-left:var(--snk-expression-item__itens--padding);padding-right:var(--snk-expression-item__itens--padding)}.box__container--button-delete--icon.sc-snk-expression-item{width:42px;min-width:42px}.box__container--input-value-variable--icon.sc-snk-expression-item{cursor:pointer}.dashes.sc-snk-expression-item{z-index:var(--more-visible, 2);background:var(--snk-expression-item__background-color-dashed);border-bottom:2px dashed var(--text-secondary, #A2ABB9);border-left:2px dashed var(--text-secondary, #A2ABB9);position:absolute;width:15px;height:62px;margin-left:-15px;margin-top:-33.5px}",te=class{constructor(e){F(this,e),this.ezFilterItemChange=g(this,"ezFilterItemChange",7),this.ezFilterItemRemove=g(this,"ezFilterItemRemove",7),this.application=L.getContextValue("__SNK__APPLICATION__"),this.filterOperandDefault=Z,this.filterOperandTypeTextSearch=ee,this.DEFAULT_FIELD_NAME="NOT_DEFINED",this._showValueVariable=!1,this._fieldSelected=void 0,this._optionNotNull=!1,this.expression=void 0,this.canRemove=!0,this.messagesBuilder=void 0,this.isDefaultFilter=!1,this.entityURI=void 0}expressionChanged(e,i){e!==i&&(this.ezFilterItemChange.emit(e),this.updateFieldSelected())}componentWillLoad(){this._dataSourceFetcher=v.get(`filterFieldsDataSource.${this.entityURI}`),v.onChange(`filterFieldsDataSource.${this.entityURI}`,()=>{this._dataSourceFetcher=v.get(`filterFieldsDataSource.${this.entityURI}`)}),this.expression&&(this.updateFieldSelected(),this._optionNotNull=this.expression.operand==="NULL"||this.expression.operand==="NOT_NULL")}componentDidRender(){var e;this._showValueVariable=(e=this._elValueVariable)===null||e===void 0?void 0:e.value}updateFieldSelected(){const e={dataType:this.expression.type,description:this.expression.description,name:this.expression.fieldName,label:this.expression.fieldLabel,entityName:this.expression.entityName,onlyDate:!1,path:this.expression.description,properties:this.expressionPropsToFieldProps(this.expression.props),type:z.FIELD,uri:"",userInterface:this.expression.userInterface};this._fieldSelected=e}buildExpression(e,i,s){return s.length>0&&s.shift(),s.length>0?`${s.join("->")}->${i}`:`${e}.${i}`}setValueExpression(e,i){e==="fieldName"?(this.expression.description=i.path,this.expression.expression=this.buildExpression(i.entityName,i.name,i.entityPath),this.expression.fieldName=i.name,this.expression.fieldLabel=i.label,this.expression.type=i.dataType,this.expression.userInterface=i.userInterface,this.expression.entityName=i.entityName,this.expression.value=void 0,this.expression.props=this.fieldPropsToExpressionProps(i.properties)):this.expression[e]=i,this.expressionChanged(this.expression)}fieldPropsToExpressionProps(e){const i=[];if(!e)return i;for(const s in e){let t=e[s];typeof t=="object"&&(t=JSON.stringify(t)),i.push({name:s,value:t})}return i}expressionPropsToFieldProps(e){const i={};return e&&e.forEach(s=>{try{i[s.name]=JSON.parse(s.value)}catch{i[s.name]=s.value}}),i}getMessage(e,i){return this.application.messagesBuilder.getMessage(e,i)}handleSelectItem(e){if(this.hasNoChanges(e)){this._elFilterInput.value=e.path;return}if(e.type===z.FIELD){const i=e;this._fieldSelected=i,this.setValueExpression("fieldName",i)}}hasNoChanges(e){return e.name===this.expression.fieldName&&e.path===this.expression.description}handleFocus(){this._elFilterFieldSearch&&this._elFilterFieldSearch.show()}handleChangeFilterInput(e){this._elFilterFieldSearch.applyFilter(e.detail)}handleChangeValueVariable(e){this._showValueVariable=e,this._elFieldDynamic&&(this._elFieldDynamic.value=void 0,this._elFieldDynamic.enabled=!e),this.expression.paramVariable=e,this.expressionChanged(this.expression)}openSnkFilterParamConfig(){var e;(e=this._elFilterParamConfigRef)===null||e===void 0||e.open(this.expression).then(this.onOpenPromiseReady.bind(this)).catch(i=>{console.error(i)})}onOpenPromiseReady(e){this.expression=e}buildOptionsOperator(){var e;return ie.includes((e=this._fieldSelected)===null||e===void 0?void 0:e.userInterface)?this.filterOperandTypeTextSearch:this.filterOperandDefault}handleChangeOperator(e){this.checkOptionIsNull(e),this.setValueExpression("operand",e)}checkOptionIsNull(e){const i=b[e];[b.NULL,b.NOT_NULL].includes(i)?(this._optionNotNull=!0,this._elFieldDynamic&&(this._elFieldDynamic.enabled=!1,this._elFieldDynamic.value=void 0)):(this._optionNotNull=!1,this._elFieldDynamic&&(this._elFieldDynamic.enabled=!this._showValueVariable))}confirmRemove(e){e.preventDefault(),e.stopPropagation(),T.confirm(this.getMessage("snkPersonalizedFilter.confirmExpression.title"),this.getMessage("snkPersonalizedFilter.confirmExpression.description")).then(i=>{i&&this.ezFilterItemRemove.emit(this.expression)})}buildFieldByType(){var e,i,s;if(!this._fieldSelected)return;const t=(e=Q(this.configureFieldByType()))===null||e===void 0?void 0:e.$children$.shift();return(this._optionNotNull&&t||!((i=this._elValueVariable)===null||i===void 0)&&i.value&&t||this.expression.paramVariable||this._showValueVariable||!(!((s=this._fieldSelected)===null||s===void 0)&&s.dataType))&&(t.$attrs$.enabled=!1),this.expression.value!=null&&(t.$attrs$.value=this.getExpressiontValue(this.expression)),t.$attrs$.onEzChange=n=>{this.setValueExpression("value",n.target.value)},this.expression.userInterface==="SWITCH"&&this.expression.value==null&&this.setValueExpression("value",!1),r(t.$tag$,Object.assign(Object.assign({},t.$attrs$),{ref:n=>{this._elFieldDynamic=n},label:this.expression.fieldLabel||this._fieldSelected.label}))}getExpressiontValue(e){return C(e.type,e.value)}configureFieldByType(){var e,i;const s={userInterface:this._fieldSelected.userInterface,name:this._fieldSelected.name,label:this._fieldSelected.label,canShowError:!1};switch(s.userInterface){case l.OPTIONSELECTOR:s.props={options:(i=(e=this._fieldSelected)===null||e===void 0?void 0:e.properties)===null||i===void 0?void 0:i.options};break;case l.LONGTEXT:s.rows=1;break;case l.SEARCH:s.optionLoader=t=>this.setCriteriaSearch(t,this.application);break}return s}setCriteriaSearch({mode:e,argument:i},s){var t,n,o;if(s==null)return;const d={showInactives:!1},p={entity:(o=(n=(t=this._fieldSelected)===null||t===void 0?void 0:t.properties)===null||n===void 0?void 0:n.ENTITYNAME)!==null&&o!==void 0?o:this._fieldSelected.entityName,searchOptions:d,entityDescription:this._fieldSelected.description};return s.executePreparedSearch(e,i,p)}render(){var e;return r(I,null,r("div",{class:"dashes"}),r("div",{class:"box"},r("div",{class:"box__container"},r("div",{class:"box__container--input-filter"},r("ez-filter-input",Object.assign({ref:i=>this._elFilterInput=i,value:(e=this._fieldSelected)===null||e===void 0?void 0:e.path,label:this.getMessage("snkPersonalizedFilter.info.labelSearchField"),canShowError:!1,onEzChange:i=>this.handleChangeFilterInput(i),onFocus:()=>this.handleFocus()},{[f.DATA_ELEMENT_ID_ATTRIBUTE_NAME]:`expressionFilterInput_${this.expression.fieldName||this.DEFAULT_FIELD_NAME}`})),r("snk-filter-field-search",{ref:i=>this._elFilterFieldSearch=i,searchable:!1,onEzSelectFilterItem:i=>this.handleSelectItem(i.detail),fieldsDataSource:this._dataSourceFetcher})),r("div",{class:"box__container--input-operator"},r("ez-combo-box",Object.assign({label:this.getMessage("snkPersonalizedFilter.info.labelOperator"),value:this.expression.operand,canShowError:!1,options:this.buildOptionsOperator(),onEzChange:i=>{var s;return this.handleChangeOperator((s=i.detail)===null||s===void 0?void 0:s.value)},suppressEmptyOption:!0},{[f.DATA_ELEMENT_ID_ATTRIBUTE_NAME]:`comboBoxOperand_${this.expression.fieldName||this.DEFAULT_FIELD_NAME}`}))),r("div",{class:"box__container--input-value"},this._fieldSelected?this.buildFieldByType():r("ez-number-input",{label:"Valor",canShowError:!1,enabled:!this._showValueVariable&&!this._optionNotNull})),r("div",{class:"box__container--input-value-variable"},!this._optionNotNull&&r("ez-tooltip",{message:this.getMessage("snkPersonalizedFilter.info.checkVariableDisabled"),active:this.isDefaultFilter},r("ez-check",{ref:i=>this._elValueVariable=i,value:this.expression.paramVariable,label:this.getMessage("snkPersonalizedFilter.info.labelValueVarible"),mode:E.SWITCH,onEzChange:i=>this.handleChangeValueVariable(i.detail),enabled:!this.isDefaultFilter})),this._showValueVariable&&!this._optionNotNull&&r("ez-icon",Object.assign({class:"box__container--input-value-variable--icon",size:"large",iconName:"settings-inverted"},{[f.DATA_ELEMENT_ID_ATTRIBUTE_NAME]:"iconConfig"},{title:this.getMessage("snkPersonalizedFilter.info.titleTooltip"),onClick:()=>this.openSnkFilterParamConfig()})),r("snk-filter-param-config",{ref:i=>this._elFilterParamConfigRef=i,messagesBuilder:this.messagesBuilder})),r("div",{class:"box__container--button-delete"},r("div",{class:"box__container--button-delete--icon"},r("ez-button",{mode:"icon",iconName:"delete",enabled:this.canRemove,label:this.getMessage("snkPersonalizedFilter.info.labelDeleteItem"),onClick:i=>this.confirmRemove(i)}))))))}static get watchers(){return{expression:["expressionChanged"]}}};te.style=se;export{q as snk_expression_group,te as snk_expression_item};

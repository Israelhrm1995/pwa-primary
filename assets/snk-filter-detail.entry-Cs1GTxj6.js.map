{"version":3,"file":"snk-filter-detail.entry-Cs1GTxj6.js","sources":["../../node_modules/@sankhyalabs/sankhyablocks/dist/esm/snk-filter-detail.entry.js"],"sourcesContent":["import { r as registerInstance, c as createEvent, h, F as Fragment, H as Host, g as getElement } from './index-479e1293.js';\nimport { ApplicationUtils } from '@sankhyalabs/ezui/dist/collection/utils';\nimport { F as FilterItemType } from './filter-item-type.enum-d45e026f.js';\nimport { ElementIDUtils, ObjectUtils } from '@sankhyalabs/core';\nimport { E as EPresentationMode } from './presentationMode-783bbf9d.js';\nimport { P as PersonalizedFilterUtils } from './PersonalizedFilterUtils-2db38ff2.js';\nimport './index-8acbae97.js';\n\nconst SnkFilterDetail = class {\n  constructor(hostRef) {\n    registerInstance(this, hostRef);\n    this.filterChange = createEvent(this, \"filterChange\", 7);\n    this.config = undefined;\n    this.getMessage = undefined;\n    this.showHardFixed = true;\n  }\n  /**\n   * Exibe o componente snk-filter-detail.\n   */\n  async show() {\n    var _a, _b;\n    (_b = (_a = this._editor) === null || _a === void 0 ? void 0 : _a[\"show\"]) === null || _b === void 0 ? void 0 : _b.call(_a);\n  }\n  observeConfig(newValue) {\n    var _a, _b;\n    this._editor && (this._editor[\"config\"] = newValue);\n    (_b = (_a = this._editor) === null || _a === void 0 ? void 0 : _a[\"reloadList\"]) === null || _b === void 0 ? void 0 : _b.call(_a);\n    this._customElementObject = this.getContentEditor();\n  }\n  componentDidLoad() {\n    if (this._element) {\n      ElementIDUtils.addIDInfo(this._element);\n      const dataElementIdDoFilterItem = this._element.getAttribute(ElementIDUtils.DATA_ELEMENT_ID_ATTRIBUTE_NAME);\n      this._idContentEditor = `${dataElementIdDoFilterItem}_${this.config.id}`;\n    }\n  }\n  changeConfig(newConfig) {\n    this.filterChange.emit(newConfig);\n  }\n  getContentEditor() {\n    switch (this.config.type) {\n      case FilterItemType.BINARY_SELECT:\n        return { tag: \"snk-filter-binary-select\" };\n      case FilterItemType.MULTI_SELECT:\n        return { tag: \"snk-filter-multi-select\" };\n      case FilterItemType.PERIOD:\n        return { tag: \"snk-filter-period\" };\n      case FilterItemType.SEARCH:\n        return { tag: \"snk-filter-search\" };\n      case FilterItemType.NUMBER:\n        return { tag: \"snk-filter-number\" };\n      case FilterItemType.PERSONALIZED:\n        const snkFilterPersonalizedProps = {\n          tag: \"snk-personalized-filter-editor\", props: {\n            presentationMode: EPresentationMode.CHIP,\n            onValueChanged: evt => this.handleValueChanged(evt),\n          }\n        };\n        return snkFilterPersonalizedProps;\n      case FilterItemType.CHECK_BOX_LIST:\n        return {\n          tag: \"snk-filter-checkbox-list\",\n          props: {\n            onValueChanged: evt => this.config = Object.assign(Object.assign({}, this.config), { value: evt.detail })\n          }\n        };\n      case FilterItemType.MULTI_LIST:\n        return {\n          tag: \"snk-entity-list\",\n          props: {\n            onValueChanged: evt => this.config = Object.assign(Object.assign({}, this.config), { value: evt.detail })\n          }\n        };\n    }\n    return { tag: \"snk-filter-text\" };\n  }\n  handleValueChanged({ detail }) {\n    const groupedItems = (detail === null || detail === void 0 ? void 0 : detail.items) || this.config.groupedItems;\n    this.config = Object.assign(Object.assign({}, this.config), { groupedItems, visible: (groupedItems || []).filter(item => item.visible).length > 0 });\n  }\n  removeItem() {\n    const hasMultiValues = this.config.type === FilterItemType.MULTI_LIST && Array.isArray(this.config.value);\n    const newValue = hasMultiValues ? this.config.value.map((valueItem) => (Object.assign(Object.assign({}, valueItem), { check: false }))) : undefined;\n    const removedConfig = Object.assign(Object.assign({}, this.config), { visible: false, fixed: false, value: newValue });\n    if (removedConfig.groupedItems != undefined) {\n      removedConfig.groupedItems = removedConfig.groupedItems.map(item => (Object.assign(Object.assign({}, item), { visible: false, fixed: false, value: undefined })));\n    }\n    this.changeConfig(removedConfig);\n  }\n  removeItemFromGroup(item) {\n    return Object.assign(Object.assign({}, item), { visible: false, fixed: false, value: undefined });\n  }\n  getPopUpHeaderButtons() {\n    return (h(Fragment, null, !this.config.removalBlocked &&\n      this.buildIcon(this.getMessage(\"snkFilterBar.removeFilter\"), \"delete\", () => this.removeItem()), this.showHardFixed && !this.config.hardFixed &&\n      this.buildIcon(this.getMessage(this.config.fixed ? \"snkFilterBar.unpinFilter\" : \"snkFilterBar.pinFilter\"), this.config.fixed ? \"un-pin\" : \"push-pin\", () => this.changeConfig(Object.assign(Object.assign({}, this.config), { fixed: !this.config.fixed })))));\n  }\n  buildIcon(title, iconName, action) {\n    return (h(\"button\", { onClick: () => action(), class: \"sc-snk-filter-bar snk-filter-item__editor-header-button\", ref: elem => elem && this.buildIdButton(elem, title) }, h(\"ez-icon\", Object.assign({ title: title, iconName: iconName }, { [ElementIDUtils.DATA_ELEMENT_ID_ATTRIBUTE_NAME]: `${ElementIDUtils.getInternalIDInfo(`_${title}`)}` }))));\n  }\n  buildIdButton(buttonElement, title) {\n    if (!buttonElement)\n      return;\n    const dataElement = { id: title };\n    buttonElement.removeAttribute(ElementIDUtils.DATA_ELEMENT_ID_ATTRIBUTE_NAME);\n    ElementIDUtils.addIDInfoIfNotExists(buttonElement, \"button\", dataElement);\n  }\n  clearBinarySelectValues() {\n    var _a;\n    const editor = this._editor || {};\n    (_a = editor.resetValues) === null || _a === void 0 ? void 0 : _a.call(editor);\n    this.config = ObjectUtils.copy(this.originalConfig);\n    this.changeConfig(Object.assign(Object.assign({}, this.config), { value: undefined }));\n  }\n  apply() {\n    const isValid = PersonalizedFilterUtils.validateVariableValues(this.config, this._editor[\"value\"]);\n    if (!isValid) {\n      return ApplicationUtils.alert(this.getMessage('snkFilterBar.filterModal.validations.notFullFilled.title'), this.getMessage('snkFilterBar.filterModal.validations.notFullFilled.message'));\n    }\n    const valuesArray = this._editor[\"value\"] !== undefined ? this._editor[\"value\"] : this.config.value;\n    this.changeConfig(Object.assign(Object.assign({}, this.config), { visible: this.isVisible(), value: valuesArray }));\n  }\n  isVisible() {\n    if (this.config.groupedItems && this.config.groupedItems.length > 0) {\n      return this.config.groupedItems.filter(item => item.visible).length > 0;\n    }\n    return true;\n  }\n  clear() {\n    var _a;\n    if (this.config.type === FilterItemType.BINARY_SELECT) {\n      this.clearBinarySelectValues();\n      return;\n    }\n    if (FilterItemType.MULTI_LIST === this.config.type) {\n      const configCopy = ObjectUtils.copy(this.config);\n      (_a = configCopy.value) === null || _a === void 0 ? void 0 : _a.forEach(value => !!value && (value.check = false));\n      this.config = ObjectUtils.copy(configCopy);\n      return;\n    }\n    this.changeConfig(Object.assign(Object.assign({}, this.config), { value: undefined }));\n  }\n  filterCanBeCleared() {\n    return this.config.type !== FilterItemType.PERSONALIZED;\n  }\n  onKeyDonwListener(event) {\n    if (event.key === \"Enter\") {\n      this._applyButton.setFocus().then(() => this.apply());\n    }\n  }\n  buildRightSlot(item) {\n    return h(\"ez-icon\", { iconName: \"delete\", onClick: () => this.removeValueFromConfig(item) });\n  }\n  removeValueFromConfig(item) {\n    var _a, _b;\n    if (this.config) {\n      const configCopy = ObjectUtils.copy(this.config);\n      const index = (_a = configCopy.value) === null || _a === void 0 ? void 0 : _a.findIndex(i => (i === null || i === void 0 ? void 0 : i.id) === item.id);\n      (_b = configCopy.value) === null || _b === void 0 ? void 0 : _b.splice(index, 1);\n      this.config = ObjectUtils.copy(configCopy);\n    }\n  }\n  componentWillLoad() {\n    this.originalConfig = ObjectUtils.copy(this.config);\n    this._customElementObject = this.getContentEditor();\n  }\n  render() {\n    const { tag: CustomElement, props } = this._customElementObject;\n    return (h(Host, null, h(\"div\", { class: \"col ez-col--sd-12 ez-align--right ez-padding-medium ez-flex--align-items-center\" }, h(\"div\", { class: \"ez-text ez-title ez-title--small ez-padding--small sc-snk-filter-bar snk-filter-item__editor-header\" }, this.config.detailTitle), this.getPopUpHeaderButtons()), h(CustomElement, Object.assign({ maxHeightList: '240px', ref: ref => this._editor = ref, value: this.config.value, config: this.config, onKeyDown: evt => this.onKeyDonwListener(evt), \"data-element-id\": this._idContentEditor, getMessage: this.getMessage, rightListSlotBuilder: item => this.buildRightSlot(item) }, props)), h(\"hr\", { class: \"sc-snk-filter-bar snk-filter__popover-rule\" }), h(\"div\", { class: \"ez-col ez-col--sd-12 ez-align--right\" }, this.filterCanBeCleared() && (h(\"ez-button\", { label: this.getMessage(\"snkFilterBar.cleanFilter\"), onClick: () => this.clear(), size: \"small\" })), h(\"ez-button\", { ref: ref => this._applyButton = ref, label: this.getMessage(\"snkFilterBar.applyFilter\"), onClick: () => this.apply(), size: \"small\", class: \"ez-button--primary ez-padding-left--medium\" }))));\n  }\n  get _element() { return getElement(this); }\n  static get watchers() { return {\n    \"config\": [\"observeConfig\"]\n  }; }\n};\n\nexport { SnkFilterDetail as snk_filter_detail };\n"],"names":["SnkFilterDetail","hostRef","registerInstance","createEvent","_a","_b","newValue","ElementIDUtils","dataElementIdDoFilterItem","newConfig","FilterItemType","EPresentationMode","evt","detail","groupedItems","item","valueItem","removedConfig","h","Fragment","title","iconName","action","elem","buttonElement","dataElement","editor","ObjectUtils","PersonalizedFilterUtils","ApplicationUtils","valuesArray","configCopy","value","event","index","i","CustomElement","props","Host","ref","getElement"],"mappings":"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","x_google_ignoreList":[0]}
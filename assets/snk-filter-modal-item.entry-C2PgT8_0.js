import{r as h,c as o,h as s,H as u,g as f}from"./index-a3IjaFud.js";import{E as a,O as c}from"./dataUnitInMemoryLoader-BjgoPaoq.js";import{F as i}from"./filter-item-type.enum-d45e026f-B41QHsvD.js";import{E as g}from"./presentationMode-783bbf9d-DynInUa-.js";import{C as I}from"./ConfigStorage-89154c4e-iTHVKliQ.js";import{F as p}from"./filter-type.enum-f6a8fe23-UC9SJhBV.js";import"./form-config-fetcher-e623539b-By6wLJV7.js";import"./DataFetcher-db08cad0-B7lG84WQ.js";import"./PrintUtils-3e4ff0f5-DDjQRNo9.js";import"./ApplicationContext-B_qAnYBt.js";const v=".grow{flex-grow:1}.gap{gap:4px}",E=class{constructor(e){h(this,e),this.filterChange=o(this,"filterChange",7),this.editPersonalizedFilter=o(this,"editPersonalizedFilter",7),this.addPersonalizedFilter=o(this,"addPersonalizedFilter",7),this.filterItem=void 0,this.configName=void 0,this.resourceID=void 0}observeFilterItem(e){var t,r;this._editor&&(this._editor.config=e),(r=(t=this._editor)===null||t===void 0?void 0:t.reloadList)===null||r===void 0||r.call(t),this.filterChange.emit(e)}getContentEditorConfig(){const e={presentationMode:g.MODAL};switch(this.filterItem.type){case i.BINARY_SELECT:return{tag:"snk-filter-binary-select",props:e};case i.MULTI_SELECT:return{tag:"snk-filter-multi-select"};case i.PERIOD:return{tag:"snk-filter-period",props:e};case i.SEARCH:return{tag:"snk-filter-search"};case i.NUMBER:return{tag:"snk-filter-number",props:e};case i.PERSONALIZED:return this.buildSnkFilterPersonalizedProps();case i.CHECK_BOX_LIST:return{tag:"snk-filter-checkbox-list",props:e};case i.MULTI_LIST:return{tag:"snk-entity-list",props:{maxHeightList:"640px",rightListSlotBuilder:t=>this.buildRightSlot(t)}}}return{tag:"snk-filter-text"}}buildSnkFilterPersonalizedProps(){return{tag:"snk-personalized-filter-editor",props:{onEditFilter:e=>this.editPersonalizedFilter.emit(e.detail),onAddFilter:()=>this.addPersonalizedFilter.emit()}}}isVisible(e){return this.filterItem.visible?!0:e!==void 0}updateFilterValue(e){const t=(e==null?void 0:e.value)!==void 0?e.value:e;this.filterItem.groupedItems!=null?this.filterItem=Object.assign(Object.assign({},this.filterItem),{visible:t>0,value:t,groupedItems:e.items}):this.filterItem=Object.assign(Object.assign({},this.filterItem),{value:this.filterItem.type===(i.SEARCH||i.CHECK_BOX_LIST)?e:t,visible:this.isVisible(t)})}handleDeleteFilter(e,t){t===i.PERSONALIZED&&I.removePersonalizedFilter(e,this.resourceID,this.configName)}componentDidLoad(){if(this._element){a.addIDInfo(this._element);const e=this._element.getAttribute(a.DATA_ELEMENT_ID_ATTRIBUTE_NAME);this._idContentEditor=`${e}_${this.filterItem.id}`}}buildRightSlot(e){return s("ez-icon",{iconName:"delete",onClick:()=>this.removeValueFromConfig(e)})}removeValueFromConfig(e){var t,r,n;const d=(r=(t=this.filterItem)===null||t===void 0?void 0:t.value)===null||r===void 0?void 0:r.findIndex(({id:m})=>m===e.id),l=c.copy(this.filterItem);(n=l==null?void 0:l.value)===null||n===void 0||n.splice(d,1),this.updateFilterValue(l.value)}canShowDetailModal(){const{CUSTOM_FILTER:e,OTHER_FILTERS:t}=p;return![e,t].includes(this.filterItem.filterType)&&this.filterItem.type!==i.BINARY_SELECT}render(){const{tag:e,props:t}=this.getContentEditorConfig();return s(u,null,s("div",{class:"ez-flex ez-flex--column grow"},this.canShowDetailModal()&&s("div",{class:"col ez-col--sd-12 ez-align--right ez-padding-medium ez-flex--align-items-center"},s("div",{class:"ez-title ez-title--small ez-title--primary grow"},this.filterItem.detailModal)),s(e,Object.assign({ref:r=>this._editor=r,config:this.filterItem,value:this.filterItem.value,onValueChanged:r=>this.updateFilterValue(r.detail),"data-element-id":this._idContentEditor},t))))}get _element(){return f(this)}static get watchers(){return{filterItem:["observeFilterItem"]}}};E.style=v;export{E as snk_filter_modal_item};
